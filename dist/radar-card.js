function t(t,e,n,i){var r,a=arguments.length,o=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(a<3?r(o):a>3?r(e,n,o):r(e,n))||o);return a>3&&o&&Object.defineProperty(e,n,o),o}console.groupCollapsed("%cRADAR-CARD%cv1.0.1","color: orange; font-weight: bold; background: black; padding: 2px 4px; border-radius: 2px 0 0 2px;","color: white; font-weight: bold; background: dimgray; padding: 2px 4px; border-radius: 0 2px 2px 0;"),console.info("Plot multiple `device_tracker` entities on a polar chart."),console.info("Github:  https://github.com/timmaurice/lovelace-radar-card.git"),console.info("Sponsor: https://buymeacoffee.com/timmaurice"),console.groupEnd(),"function"==typeof SuppressedError&&SuppressedError;
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const e=globalThis,n=e.ShadowRoot&&(void 0===e.ShadyCSS||e.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,i=Symbol(),r=new WeakMap;let a=class{constructor(t,e,n){if(this._$cssResult$=!0,n!==i)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(n&&void 0===t){const n=void 0!==e&&1===e.length;n&&(t=r.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),n&&r.set(e,t))}return t}toString(){return this.cssText}};const o=t=>new a("string"==typeof t?t:t+"",void 0,i),s=(t,...e)=>{const n=1===t.length?t[0]:e.reduce((e,n,i)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(n)+t[i+1],t[0]);return new a(n,t,i)},l=n?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e="";for(const n of t.cssRules)e+=n.cssText;return o(e)})(t):t,{is:c,defineProperty:d,getOwnPropertyDescriptor:h,getOwnPropertyNames:u,getOwnPropertySymbols:p,getPrototypeOf:f}=Object,g=globalThis,_=g.trustedTypes,m=_?_.emptyScript:"",v=g.reactiveElementPolyfillSupport,y=(t,e)=>t,b={toAttribute(t,e){switch(e){case Boolean:t=t?m:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=null!==t;break;case Number:n=null===t?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch(t){n=null}}return n}},w=(t,e)=>!c(t,e),x={attribute:!0,type:String,converter:b,reflect:!1,useDefault:!1,hasChanged:w};
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */Symbol.metadata??=Symbol("metadata"),g.litPropertyMetadata??=new WeakMap;let $=class extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,e=x){if(e.state&&(e.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((e=Object.create(e)).wrapped=!0),this.elementProperties.set(t,e),!e.noAccessor){const n=Symbol(),i=this.getPropertyDescriptor(t,n,e);void 0!==i&&d(this.prototype,t,i)}}static getPropertyDescriptor(t,e,n){const{get:i,set:r}=h(this.prototype,t)??{get(){return this[e]},set(t){this[e]=t}};return{get:i,set(e){const a=i?.call(this);r?.call(this,e),this.requestUpdate(t,a,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??x}static _$Ei(){if(this.hasOwnProperty(y("elementProperties")))return;const t=f(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(y("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(y("properties"))){const t=this.properties,e=[...u(t),...p(t)];for(const n of e)this.createProperty(n,t[n])}const t=this[Symbol.metadata];if(null!==t){const e=litPropertyMetadata.get(t);if(void 0!==e)for(const[t,n]of e)this.elementProperties.set(t,n)}this._$Eh=new Map;for(const[t,e]of this.elementProperties){const n=this._$Eu(t,e);void 0!==n&&this._$Eh.set(n,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const n=new Set(t.flat(1/0).reverse());for(const t of n)e.unshift(l(t))}else void 0!==t&&e.push(l(t));return e}static _$Eu(t,e){const n=e.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(t=>t(this))}addController(t){(this._$EO??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,e=this.constructor.elementProperties;for(const n of e.keys())this.hasOwnProperty(n)&&(t.set(n,this[n]),delete this[n]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return((t,i)=>{if(n)t.adoptedStyleSheets=i.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const n of i){const i=document.createElement("style"),r=e.litNonce;void 0!==r&&i.setAttribute("nonce",r),i.textContent=n.cssText,t.appendChild(i)}})(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(t=>t.hostConnected?.())}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach(t=>t.hostDisconnected?.())}attributeChangedCallback(t,e,n){this._$AK(t,n)}_$ET(t,e){const n=this.constructor.elementProperties.get(t),i=this.constructor._$Eu(t,n);if(void 0!==i&&!0===n.reflect){const r=(void 0!==n.converter?.toAttribute?n.converter:b).toAttribute(e,n.type);this._$Em=t,null==r?this.removeAttribute(i):this.setAttribute(i,r),this._$Em=null}}_$AK(t,e){const n=this.constructor,i=n._$Eh.get(t);if(void 0!==i&&this._$Em!==i){const t=n.getPropertyOptions(i),r="function"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:b;this._$Em=i;const a=r.fromAttribute(e,t.type);this[i]=a??this._$Ej?.get(i)??a,this._$Em=null}}requestUpdate(t,e,n){if(void 0!==t){const i=this.constructor,r=this[t];if(n??=i.getPropertyOptions(t),!((n.hasChanged??w)(r,e)||n.useDefault&&n.reflect&&r===this._$Ej?.get(t)&&!this.hasAttribute(i._$Eu(t,n))))return;this.C(t,e,n)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(t,e,{useDefault:n,reflect:i,wrapped:r},a){n&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,a??e??this[t]),!0!==r||void 0!==a)||(this._$AL.has(t)||(this.hasUpdated||n||(e=void 0),this._$AL.set(t,e)),!0===i&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,e]of this._$Ep)this[t]=e;this._$Ep=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[e,n]of t){const{wrapped:t}=n,i=this[e];!0!==t||this._$AL.has(e)||void 0===i||this.C(e,void 0,n,i)}}let t=!1;const e=this._$AL;try{t=this.shouldUpdate(e),t?(this.willUpdate(e),this._$EO?.forEach(t=>t.hostUpdate?.()),this.update(e)):this._$EM()}catch(e){throw t=!1,this._$EM(),e}t&&this._$AE(e)}willUpdate(t){}_$AE(t){this._$EO?.forEach(t=>t.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach(t=>this._$ET(t,this[t])),this._$EM()}updated(t){}firstUpdated(t){}};$.elementStyles=[],$.shadowRootOptions={mode:"open"},$[y("elementProperties")]=new Map,$[y("finalized")]=new Map,v?.({ReactiveElement:$}),(g.reactiveElementVersions??=[]).push("2.1.1");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const k=globalThis,A=k.trustedTypes,M=A?A.createPolicy("lit-html",{createHTML:t=>t}):void 0,E="$lit$",C=`lit$${Math.random().toFixed(9).slice(2)}$`,S="?"+C,z=`<${S}>`,P=document,N=()=>P.createComment(""),j=t=>null===t||"object"!=typeof t&&"function"!=typeof t,O=Array.isArray,I="[ \t\n\f\r]",T=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,D=/-->/g,L=/>/g,H=RegExp(`>|${I}(?:([^\\s"'>=/]+)(${I}*=${I}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),R=/'/g,U=/"/g,q=/^(?:script|style|textarea|title)$/i,B=(t=>(e,...n)=>({_$litType$:t,strings:e,values:n}))(1),F=Symbol.for("lit-noChange"),V=Symbol.for("lit-nothing"),W=new WeakMap,X=P.createTreeWalker(P,129);function K(t,e){if(!O(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==M?M.createHTML(e):e}const Z=(t,e)=>{const n=t.length-1,i=[];let r,a=2===e?"<svg>":3===e?"<math>":"",o=T;for(let e=0;e<n;e++){const n=t[e];let s,l,c=-1,d=0;for(;d<n.length&&(o.lastIndex=d,l=o.exec(n),null!==l);)d=o.lastIndex,o===T?"!--"===l[1]?o=D:void 0!==l[1]?o=L:void 0!==l[2]?(q.test(l[2])&&(r=RegExp("</"+l[2],"g")),o=H):void 0!==l[3]&&(o=H):o===H?">"===l[0]?(o=r??T,c=-1):void 0===l[1]?c=-2:(c=o.lastIndex-l[2].length,s=l[1],o=void 0===l[3]?H:'"'===l[3]?U:R):o===U||o===R?o=H:o===D||o===L?o=T:(o=H,r=void 0);const h=o===H&&t[e+1].startsWith("/>")?" ":"";a+=o===T?n+z:c>=0?(i.push(s),n.slice(0,c)+E+n.slice(c)+C+h):n+C+(-2===c?e:h)}return[K(t,a+(t[n]||"<?>")+(2===e?"</svg>":3===e?"</math>":"")),i]};class Y{constructor({strings:t,_$litType$:e},n){let i;this.parts=[];let r=0,a=0;const o=t.length-1,s=this.parts,[l,c]=Z(t,e);if(this.el=Y.createElement(l,n),X.currentNode=this.el.content,2===e||3===e){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(i=X.nextNode())&&s.length<o;){if(1===i.nodeType){if(i.hasAttributes())for(const t of i.getAttributeNames())if(t.endsWith(E)){const e=c[a++],n=i.getAttribute(t).split(C),o=/([.?@])?(.*)/.exec(e);s.push({type:1,index:r,name:o[2],strings:n,ctor:"."===o[1]?et:"?"===o[1]?nt:"@"===o[1]?it:tt}),i.removeAttribute(t)}else t.startsWith(C)&&(s.push({type:6,index:r}),i.removeAttribute(t));if(q.test(i.tagName)){const t=i.textContent.split(C),e=t.length-1;if(e>0){i.textContent=A?A.emptyScript:"";for(let n=0;n<e;n++)i.append(t[n],N()),X.nextNode(),s.push({type:2,index:++r});i.append(t[e],N())}}}else if(8===i.nodeType)if(i.data===S)s.push({type:2,index:r});else{let t=-1;for(;-1!==(t=i.data.indexOf(C,t+1));)s.push({type:7,index:r}),t+=C.length-1}r++}}static createElement(t,e){const n=P.createElement("template");return n.innerHTML=t,n}}function G(t,e,n=t,i){if(e===F)return e;let r=void 0!==i?n._$Co?.[i]:n._$Cl;const a=j(e)?void 0:e._$litDirective$;return r?.constructor!==a&&(r?._$AO?.(!1),void 0===a?r=void 0:(r=new a(t),r._$AT(t,n,i)),void 0!==i?(n._$Co??=[])[i]=r:n._$Cl=r),void 0!==r&&(e=G(t,r._$AS(t,e.values),r,i)),e}class J{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:e},parts:n}=this._$AD,i=(t?.creationScope??P).importNode(e,!0);X.currentNode=i;let r=X.nextNode(),a=0,o=0,s=n[0];for(;void 0!==s;){if(a===s.index){let e;2===s.type?e=new Q(r,r.nextSibling,this,t):1===s.type?e=new s.ctor(r,s.name,s.strings,this,t):6===s.type&&(e=new rt(r,this,t)),this._$AV.push(e),s=n[++o]}a!==s?.index&&(r=X.nextNode(),a++)}return X.currentNode=P,i}p(t){let e=0;for(const n of this._$AV)void 0!==n&&(void 0!==n.strings?(n._$AI(t,n,e),e+=n.strings.length-2):n._$AI(t[e])),e++}}class Q{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,e,n,i){this.type=2,this._$AH=V,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=n,this.options=i,this._$Cv=i?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===t?.nodeType&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=G(this,t,e),j(t)?t===V||null==t||""===t?(this._$AH!==V&&this._$AR(),this._$AH=V):t!==this._$AH&&t!==F&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):(t=>O(t)||"function"==typeof t?.[Symbol.iterator])(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==V&&j(this._$AH)?this._$AA.nextSibling.data=t:this.T(P.createTextNode(t)),this._$AH=t}$(t){const{values:e,_$litType$:n}=t,i="number"==typeof n?this._$AC(t):(void 0===n.el&&(n.el=Y.createElement(K(n.h,n.h[0]),this.options)),n);if(this._$AH?._$AD===i)this._$AH.p(e);else{const t=new J(i,this),n=t.u(this.options);t.p(e),this.T(n),this._$AH=t}}_$AC(t){let e=W.get(t.strings);return void 0===e&&W.set(t.strings,e=new Y(t)),e}k(t){O(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let n,i=0;for(const r of t)i===e.length?e.push(n=new Q(this.O(N()),this.O(N()),this,this.options)):n=e[i],n._$AI(r),i++;i<e.length&&(this._$AR(n&&n._$AB.nextSibling,i),e.length=i)}_$AR(t=this._$AA.nextSibling,e){for(this._$AP?.(!1,!0,e);t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t))}}class tt{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,e,n,i,r){this.type=1,this._$AH=V,this._$AN=void 0,this.element=t,this.name=e,this._$AM=i,this.options=r,n.length>2||""!==n[0]||""!==n[1]?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=V}_$AI(t,e=this,n,i){const r=this.strings;let a=!1;if(void 0===r)t=G(this,t,e,0),a=!j(t)||t!==this._$AH&&t!==F,a&&(this._$AH=t);else{const i=t;let o,s;for(t=r[0],o=0;o<r.length-1;o++)s=G(this,i[n+o],e,o),s===F&&(s=this._$AH[o]),a||=!j(s)||s!==this._$AH[o],s===V?t=V:t!==V&&(t+=(s??"")+r[o+1]),this._$AH[o]=s}a&&!i&&this.j(t)}j(t){t===V?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}}class et extends tt{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===V?void 0:t}}class nt extends tt{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==V)}}class it extends tt{constructor(t,e,n,i,r){super(t,e,n,i,r),this.type=5}_$AI(t,e=this){if((t=G(this,t,e,0)??V)===F)return;const n=this._$AH,i=t===V&&n!==V||t.capture!==n.capture||t.once!==n.once||t.passive!==n.passive,r=t!==V&&(n===V||i);i&&this.element.removeEventListener(this.name,this,n),r&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class rt{constructor(t,e,n){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(t){G(this,t)}}const at=k.litHtmlPolyfillSupport;at?.(Y,Q),(k.litHtmlVersions??=[]).push("3.3.1");const ot=globalThis;
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */class st extends ${constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=((t,e,n)=>{const i=n?.renderBefore??e;let r=i._$litPart$;if(void 0===r){const t=n?.renderBefore??null;i._$litPart$=r=new Q(e.insertBefore(N(),t),t,void 0,n??{})}return r._$AI(t),r})(e,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return F}}st._$litElement$=!0,st.finalized=!0,ot.litElementHydrateSupport?.({LitElement:st});const lt=ot.litElementPolyfillSupport;lt?.({LitElement:st}),(ot.litElementVersions??=[]).push("4.2.1");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const ct=t=>(e,n)=>{void 0!==n?n.addInitializer(()=>{customElements.define(t,e)}):customElements.define(t,e)},dt={attribute:!0,type:String,converter:b,reflect:!1,hasChanged:w},ht=(t=dt,e,n)=>{const{kind:i,metadata:r}=n;let a=globalThis.litPropertyMetadata.get(r);if(void 0===a&&globalThis.litPropertyMetadata.set(r,a=new Map),"setter"===i&&((t=Object.create(t)).wrapped=!0),a.set(n.name,t),"accessor"===i){const{name:i}=n;return{set(n){const r=e.get.call(this);e.set.call(this,n),this.requestUpdate(i,r,t)},init(e){return void 0!==e&&this.C(i,void 0,t,e),e}}}if("setter"===i){const{name:i}=n;return function(n){const r=this[i];e.call(this,n),this.requestUpdate(i,r,t)}}throw Error("Unsupported decorator location: "+i)};
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function ut(t){return(e,n)=>"object"==typeof n?ht(t,e,n):((t,e,n)=>{const i=e.hasOwnProperty(n);return e.constructor.createProperty(n,t),i?Object.getOwnPropertyDescriptor(e,n):void 0})(t,e,n)}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function pt(t){return ut({...t,state:!0,attribute:!1})}function ft(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function gt(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function _t(t){let e,n,i;function r(t,i,r=0,a=t.length){if(r<a){if(0!==e(i,i))return a;do{const e=r+a>>>1;n(t[e],i)<0?r=e+1:a=e}while(r<a)}return r}return 2!==t.length?(e=ft,n=(e,n)=>ft(t(e),n),i=(e,n)=>t(e)-n):(e=t===ft||t===gt?t:mt,n=t,i=t),{left:r,center:function(t,e,n=0,a=t.length){const o=r(t,e,n,a-1);return o>n&&i(t[o-1],e)>-i(t[o],e)?o-1:o},right:function(t,i,r=0,a=t.length){if(r<a){if(0!==e(i,i))return a;do{const e=r+a>>>1;n(t[e],i)<=0?r=e+1:a=e}while(r<a)}return r}}}function mt(){return 0}const vt=_t(ft).right;_t(function(t){return null===t?NaN:+t}).center;const yt=Math.sqrt(50),bt=Math.sqrt(10),wt=Math.sqrt(2);function xt(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(i)),a=i/Math.pow(10,r),o=a>=yt?10:a>=bt?5:a>=wt?2:1;let s,l,c;return r<0?(c=Math.pow(10,-r)/o,s=Math.round(t*c),l=Math.round(e*c),s/c<t&&++s,l/c>e&&--l,c=-c):(c=Math.pow(10,r)*o,s=Math.round(t/c),l=Math.round(e/c),s*c<t&&++s,l*c>e&&--l),l<s&&.5<=n&&n<2?xt(t,e,2*n):[s,l,c]}function $t(t,e,n){return xt(t=+t,e=+e,n=+n)[2]}function kt(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function At(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Mt(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Et(){}var Ct=.7,St=1/Ct,zt="\\s*([+-]?\\d+)\\s*",Pt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Nt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",jt=/^#([0-9a-f]{3,8})$/,Ot=new RegExp(`^rgb\\(${zt},${zt},${zt}\\)$`),It=new RegExp(`^rgb\\(${Nt},${Nt},${Nt}\\)$`),Tt=new RegExp(`^rgba\\(${zt},${zt},${zt},${Pt}\\)$`),Dt=new RegExp(`^rgba\\(${Nt},${Nt},${Nt},${Pt}\\)$`),Lt=new RegExp(`^hsl\\(${Pt},${Nt},${Nt}\\)$`),Ht=new RegExp(`^hsla\\(${Pt},${Nt},${Nt},${Pt}\\)$`),Rt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ut(){return this.rgb().formatHex()}function qt(){return this.rgb().formatRgb()}function Bt(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=jt.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Ft(e):3===n?new Xt(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Vt(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Vt(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Ot.exec(t))?new Xt(e[1],e[2],e[3],1):(e=It.exec(t))?new Xt(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Tt.exec(t))?Vt(e[1],e[2],e[3],e[4]):(e=Dt.exec(t))?Vt(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Lt.exec(t))?Qt(e[1],e[2]/100,e[3]/100,1):(e=Ht.exec(t))?Qt(e[1],e[2]/100,e[3]/100,e[4]):Rt.hasOwnProperty(t)?Ft(Rt[t]):"transparent"===t?new Xt(NaN,NaN,NaN,0):null}function Ft(t){return new Xt(t>>16&255,t>>8&255,255&t,1)}function Vt(t,e,n,i){return i<=0&&(t=e=n=NaN),new Xt(t,e,n,i)}function Wt(t,e,n,i){return 1===arguments.length?function(t){return t instanceof Et||(t=Bt(t)),t?new Xt((t=t.rgb()).r,t.g,t.b,t.opacity):new Xt}(t):new Xt(t,e,n,null==i?1:i)}function Xt(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function Kt(){return`#${Jt(this.r)}${Jt(this.g)}${Jt(this.b)}`}function Zt(){const t=Yt(this.opacity);return`${1===t?"rgb(":"rgba("}${Gt(this.r)}, ${Gt(this.g)}, ${Gt(this.b)}${1===t?")":`, ${t})`}`}function Yt(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Gt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Jt(t){return((t=Gt(t))<16?"0":"")+t.toString(16)}function Qt(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ee(t,e,n,i)}function te(t){if(t instanceof ee)return new ee(t.h,t.s,t.l,t.opacity);if(t instanceof Et||(t=Bt(t)),!t)return new ee;if(t instanceof ee)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),o=NaN,s=a-r,l=(a+r)/2;return s?(o=e===a?(n-i)/s+6*(n<i):n===a?(i-e)/s+2:(e-n)/s+4,s/=l<.5?a+r:2-a-r,o*=60):s=l>0&&l<1?0:o,new ee(o,s,l,t.opacity)}function ee(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function ne(t){return(t=(t||0)%360)<0?t+360:t}function ie(t){return Math.max(0,Math.min(1,t||0))}function re(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}At(Et,Bt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Ut,formatHex:Ut,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return te(this).formatHsl()},formatRgb:qt,toString:qt}),At(Xt,Wt,Mt(Et,{brighter(t){return t=null==t?St:Math.pow(St,t),new Xt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Ct:Math.pow(Ct,t),new Xt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Xt(Gt(this.r),Gt(this.g),Gt(this.b),Yt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Kt,formatHex:Kt,formatHex8:function(){return`#${Jt(this.r)}${Jt(this.g)}${Jt(this.b)}${Jt(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Zt,toString:Zt})),At(ee,function(t,e,n,i){return 1===arguments.length?te(t):new ee(t,e,n,null==i?1:i)},Mt(Et,{brighter(t){return t=null==t?St:Math.pow(St,t),new ee(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Ct:Math.pow(Ct,t),new ee(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Xt(re(t>=240?t-240:t+120,r,i),re(t,r,i),re(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new ee(ne(this.h),ie(this.s),ie(this.l),Yt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Yt(this.opacity);return`${1===t?"hsl(":"hsla("}${ne(this.h)}, ${100*ie(this.s)}%, ${100*ie(this.l)}%${1===t?")":`, ${t})`}`}}));var ae=t=>()=>t;function oe(t){return 1===(t=+t)?se:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):ae(isNaN(e)?n:e)}}function se(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):ae(isNaN(t)?e:t)}var le=function t(e){var n=oe(e);function i(t,e){var i=n((t=Wt(t)).r,(e=Wt(e)).r),r=n(t.g,e.g),a=n(t.b,e.b),o=se(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=a(e),t.opacity=o(e),t+""}}return i.gamma=t,i}(1);function ce(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(a){for(n=0;n<i;++n)r[n]=t[n]*(1-a)+e[n]*a;return r}}function de(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,a=new Array(r),o=new Array(i);for(n=0;n<r;++n)a[n]=me(t[n],e[n]);for(;n<i;++n)o[n]=e[n];return function(t){for(n=0;n<r;++n)o[n]=a[n](t);return o}}function he(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function ue(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function pe(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=me(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}var fe=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ge=new RegExp(fe.source,"g");function _e(t,e){var n,i,r,a=fe.lastIndex=ge.lastIndex=0,o=-1,s=[],l=[];for(t+="",e+="";(n=fe.exec(t))&&(i=ge.exec(e));)(r=i.index)>a&&(r=e.slice(a,r),s[o]?s[o]+=r:s[++o]=r),(n=n[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:ue(n,i)})),a=ge.lastIndex;return a<e.length&&(r=e.slice(a),s[o]?s[o]+=r:s[++o]=r),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)s[(n=l[i]).i]=n.x(t);return s.join("")})}function me(t,e){var n,i=typeof e;return null==e||"boolean"===i?ae(e):("number"===i?ue:"string"===i?(n=Bt(e))?(e=n,le):_e:e instanceof Bt?le:e instanceof Date?he:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?ce:Array.isArray(e)?de:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?pe:ue)(t,e)}function ve(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var ye,be=180/Math.PI,we={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function xe(t,e,n,i,r,a){var o,s,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,l/=s),t*i<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:r,translateY:a,rotate:Math.atan2(e,t)*be,skewX:Math.atan(l)*be,scaleX:o,scaleY:s}}function $e(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],l=[];return a=t(a),o=t(o),function(t,i,r,a,o,s){if(t!==r||i!==a){var l=o.push("translate(",null,e,null,n);s.push({i:l-4,x:ue(t,r)},{i:l-2,x:ue(i,a)})}else(r||a)&&o.push("translate("+r+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,l),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(r(n)+"rotate(",null,i)-2,x:ue(t,e)})):e&&n.push(r(n)+"rotate("+e+i)}(a.rotate,o.rotate,s,l),function(t,e,n,a){t!==e?a.push({i:n.push(r(n)+"skewX(",null,i)-2,x:ue(t,e)}):e&&n.push(r(n)+"skewX("+e+i)}(a.skewX,o.skewX,s,l),function(t,e,n,i,a,o){if(t!==n||e!==i){var s=a.push(r(a)+"scale(",null,",",null,")");o.push({i:s-4,x:ue(t,n)},{i:s-2,x:ue(e,i)})}else 1===n&&1===i||a.push(r(a)+"scale("+n+","+i+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,l),a=o=null,function(t){for(var e,n=-1,i=l.length;++n<i;)s[(e=l[n]).i]=e.x(t);return s.join("")}}}var ke=$e(function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?we:xe(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),Ae=$e(function(t){return null==t?we:(ye||(ye=document.createElementNS("http://www.w3.org/2000/svg","g")),ye.setAttribute("transform",t),(t=ye.transform.baseVal.consolidate())?xe((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):we)},", ",")",")");function Me(t){return+t}var Ee=[0,1];function Ce(t){return t}function Se(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function ze(t,e,n){var i=t[0],r=t[1],a=e[0],o=e[1];return r<i?(i=Se(r,i),a=n(o,a)):(i=Se(i,r),a=n(a,o)),function(t){return a(i(t))}}function Pe(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),a=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=Se(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=vt(t,e,1,i)-1;return a[n](r[n](e))}}function Ne(){var t,e,n,i,r,a,o=Ee,s=Ee,l=me,c=Ce;function d(){var t=Math.min(o.length,s.length);return c!==Ce&&(c=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(o[0],o[t-1])),i=t>2?Pe:ze,r=a=null,h}function h(e){return null==e||isNaN(e=+e)?n:(r||(r=i(o.map(t),s,l)))(t(c(e)))}return h.invert=function(n){return c(e((a||(a=i(s,o.map(t),ue)))(n)))},h.domain=function(t){return arguments.length?(o=Array.from(t,Me),d()):o.slice()},h.range=function(t){return arguments.length?(s=Array.from(t),d()):s.slice()},h.rangeRound=function(t){return s=Array.from(t),l=ve,d()},h.clamp=function(t){return arguments.length?(c=!!t||Ce,d()):c!==Ce},h.interpolate=function(t){return arguments.length?(l=t,d()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,i){return t=n,e=i,d()}}function je(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function Oe(t){return(t=je(Math.abs(t)))?t[1]:NaN}var Ie,Te=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function De(t){if(!(e=Te.exec(t)))throw new Error("invalid format: "+t);var e;return new Le({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Le(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function He(t,e){var n=je(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}De.prototype=Le.prototype,Le.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Re={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>He(100*t,e),r:He,s:function(t,e){var n=je(t,e);if(!n)return t+"";var i=n[0],r=n[1],a=r-(Ie=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=i.length;return a===o?i:a>o?i+new Array(a-o+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+je(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Ue(t){return t}var qe,Be,Fe,Ve=Array.prototype.map,We=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Xe(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?Ue:(e=Ve.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,a=[],o=0,s=e[0],l=0;r>0&&s>0&&(l+s+1>i&&(s=Math.max(1,i-l)),a.push(t.substring(r-=s,r+s)),!((l+=s+1)>i));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}),r=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?Ue:function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(Ve.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"−":t.minus+"",d=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=De(t)).fill,n=t.align,h=t.sign,u=t.symbol,p=t.zero,f=t.width,g=t.comma,_=t.precision,m=t.trim,v=t.type;"n"===v?(g=!0,v="g"):Re[v]||(void 0===_&&(_=12),m=!0,v="g"),(p||"0"===e&&"="===n)&&(p=!0,e="0",n="=");var y="$"===u?r:"#"===u&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",b="$"===u?a:/[%p]/.test(v)?l:"",w=Re[v],x=/[defgprs%]/.test(v);function $(t){var r,a,l,u=y,$=b;if("c"===v)$=w(t)+$,t="";else{var k=(t=+t)<0||1/t<0;if(t=isNaN(t)?d:w(Math.abs(t),_),m&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),k&&0===+t&&"+"!==h&&(k=!1),u=(k?"("===h?h:c:"-"===h||"("===h?"":h)+u,$=("s"===v?We[8+Ie/3]:"")+$+(k&&"("===h?")":""),x)for(r=-1,a=t.length;++r<a;)if(48>(l=t.charCodeAt(r))||l>57){$=(46===l?o+t.slice(r+1):t.slice(r))+$,t=t.slice(0,r);break}}g&&!p&&(t=i(t,1/0));var A=u.length+t.length+$.length,M=A<f?new Array(f-A+1).join(e):"";switch(g&&p&&(t=i(M+t,M.length?f-$.length:1/0),M=""),n){case"<":t=u+t+$+M;break;case"=":t=u+M+t+$;break;case"^":t=M.slice(0,A=M.length>>1)+u+t+$+M.slice(A);break;default:t=M+u+t+$}return s(t)}return _=void 0===_?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_)),$.toString=function(){return t+""},$}return{format:h,formatPrefix:function(t,e){var n=h(((t=De(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(Oe(e)/3))),r=Math.pow(10,-i),a=We[8+i/3];return function(t){return n(r*t)+a}}}}function Ke(t,e,n,i){var r,a=function(t,e,n){n=+n;const i=(e=+e)<(t=+t),r=i?$t(e,t,n):$t(t,e,n);return(i?-1:1)*(r<0?1/-r:r)}(t,e,n);switch((i=De(null==i?",f":i)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Oe(e)/3)))-Oe(Math.abs(t)))}(a,o))||(i.precision=r),Fe(i,o);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Oe(e)-Oe(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=function(t){return Math.max(0,-Oe(Math.abs(t)))}(a))||(i.precision=r-2*("%"===i.type))}return Be(i)}function Ze(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){if(!((n=+n)>0))return[];if((t=+t)===(e=+e))return[t];const i=e<t,[r,a,o]=i?xt(e,t,n):xt(t,e,n);if(!(a>=r))return[];const s=a-r+1,l=new Array(s);if(i)if(o<0)for(let t=0;t<s;++t)l[t]=(a-t)/-o;else for(let t=0;t<s;++t)l[t]=(a-t)*o;else if(o<0)for(let t=0;t<s;++t)l[t]=(r+t)/-o;else for(let t=0;t<s;++t)l[t]=(r+t)*o;return l}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return Ke(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,r,a=e(),o=0,s=a.length-1,l=a[o],c=a[s],d=10;for(c<l&&(r=l,l=c,c=r,r=o,o=s,s=r);d-- >0;){if((r=$t(l,c,n))===i)return a[o]=l,a[s]=c,e(a);if(r>0)l=Math.floor(l/r)*r,c=Math.ceil(c/r)*r;else{if(!(r<0))break;l=Math.ceil(l*r)/r,c=Math.floor(c*r)/r}i=r}return t},t}function Ye(){var t=Ne()(Ce,Ce);return t.copy=function(){return e=t,Ye().domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown());var e},kt.apply(t,arguments),Ze(t)}function Ge(t){return--t*t*t+1}qe=Xe({thousands:",",grouping:[3],currency:["$",""]}),Be=qe.format,Fe=qe.formatPrefix;const Je={de:{editor:{data:"Daten",title:"Titel (Optional)",auto_radar_max_distance:"Auto. max. Entfernung",auto_radar_max_distance_help:"Passt die maximale Entfernung des Radars automatisch an die am weitesten entfernte Entität an. Wenn deaktiviert, können Sie eine feste Entfernung einstellen.",radar_max_distance:"Radar max. Entfernung",center_coords_override:"Mittelpunkt überschreiben",center_coords_override_help:"Standardmäßig ist das Radar auf den Standort deines Home Assistant zentriert. Verwende dies, um einen anderen Mittelpunkt festzulegen. Der 'Statisch'-Modus verwendet eine Zonen-Entität. Der 'Beweglich'-Modus verwendet eine Personen- oder Geräte-Tracker-Entität.",center_modes:{static:"Statisch",moving:"Beweglich"},center_entity:"Mittelpunkt-Entität (beweglich)",location_zone_entity:"Mittelpunkt-Zone (statisch)",markers:"Markierungen (POIs)",enable_markers:"Markierungen aktivieren",markers_help:"Markierungen können nur im 'Beweglich'-Zentrumsmodus aktiviert werden und werden im lokalen Speicher Ihres Browsers gespeichert.",clear_all_markers:"Alle zwischengespeicherten Markierungen löschen",entities:"Entitäten",entity:"Entität",name:"Name (Optional)",color:"Farbe (Optional)",add_entity:"Entität hinzufügen",appearance:"Darstellung",grid_color:"Gitterfarbe (Optional)",font_color:"Schriftfarbe (Optional)",entity_color:"Standard Entitätsfarbe (Optional)",color_contrast_help:"Stellen Sie für die Barrierefreiheit sicher, dass alle Farben einen ausreichenden Kontrast zum Kartenhintergrund haben.",show_grid_labels:"Gitter-Entfernungsbeschriftungen anzeigen",legend:"Legende",legend_pulse_help:"Ein Klick auf eine Entität in der Legende lässt den zugehörigen Punkt auf dem Radar pulsieren, um ihn leichter zu finden.",show_legend:"Legende anzeigen",legend_position:"Legendenposition",legend_positions:{bottom:"Unten",right:"Rechts",left:"Links"},legend_show_distance:"Entfernung in Legende anzeigen",animation:"Animation",animation_enabled:"Eingangsanimation aktivieren",animation_duration:"Animationsdauer (ms)",test_animation:"Animation testen",moving_animation_enabled:"Bewegungsanimation aktivieren",moving_animation_enabled_help:"Fügt eine radarähnliche Ping-Animation für Entitäten hinzu, die sich gerade bewegen (z. B. gehen, fahren). Erfordert, dass die Entität ein 'activity'-Attribut hat.",moving_animation_activities:"Bewegungsaktivitäten (kommagetrennt)",moving_animation_activities_help:"Liste der Aktivitäten, die die Bewegungsanimation auslösen. Standard: Automotive, Cycling, Walking, Driving.",moving_animation_attribute:"Bewegungsattribut (Optional)",moving_animation_attribute_help:"Das Entitätsattribut, das auf den Aktivitätswert überprüft werden soll. Standard: 'activity'."},card:{distance:"Entfernung",azimuth:"Azimut",no_home_location:"Mittelpunkt ist in Home Assistant nicht festgelegt und es wurden keine benutzerdefinierten Koordinaten angegeben.",multiple_center_definitions:"Bitte geben Sie entweder eine Zonen-Entität oder manuelle Koordinaten für den Mittelpunkt an, nicht beides.",incomplete_center_coords:"Bitte geben Sie sowohl den Mittelpunkt-Breitengrad als auch den Mittelpunkt-Längengrad an.",no_entities:"Keine Entitäten zum Anzeigen",dialog:{name:"Name",color:"Farbe",cancel:"Abbrechen",delete:"Löschen",save:"Speichern"},directions:{N:"N",E:"O",S:"S",W:"W"}}},en:{editor:{data:"Data",title:"Title (Optional)",auto_radar_max_distance:"Auto Max Distance",auto_radar_max_distance_help:"Automatically adjusts the radar's maximum distance to fit the furthest entity. If disabled, you can set a fixed distance.",radar_max_distance:"Radar Max Distance",center_coords_override:"Center Point Override",center_coords_override_help:"By default, the radar is centered on your Home Assistant's location. Use this to specify a different center point. 'Static' mode uses a Zone entity. 'Moving' mode uses a Person or Device Tracker entity.",center_modes:{static:"Static",moving:"Moving"},center_entity:"Center Entity (Moving)",location_zone_entity:"Center Zone (Static)",markers:"Markers (Points of Interest)",enable_markers:"Enable Markers",markers_help:"Markers can only be enabled in 'Moving' center mode and are stored in your browser's local storage.",clear_all_markers:"Clear all cached markers",entities:"Entities",entity:"Entity",name:"Name (Optional)",color:"Color (Optional)",add_entity:"Add Entity",appearance:"Appearance",grid_color:"Grid Color (Optional)",font_color:"Font Color (Optional)",entity_color:"Default Entity Color (Optional)",color_contrast_help:"For accessibility, ensure all colors have sufficient contrast against the card background.",show_grid_labels:"Show Grid Distance Labels",legend:"Legend",legend_pulse_help:"Clicking an entity in the legend will make its dot on the radar pulse, making it easier to locate.",show_legend:"Show Legend",legend_position:"Legend Position",legend_positions:{bottom:"Bottom",right:"Right",left:"Left"},legend_show_distance:"Show distance in legend",animation:"Animation",animation_enabled:"Enable entry animation",animation_duration:"Animation Duration (ms)",test_animation:"Test Animation",moving_animation_enabled:"Enable moving animation",moving_animation_enabled_help:"Adds a radar-like ping animation to entities that are currently moving (e.g., walking, driving). Requires the entity to have an 'activity' attribute.",moving_animation_activities:"Moving Activities (comma-separated)",moving_animation_activities_help:"List of activities that trigger the moving animation. Defaults to: Automotive, Cycling, Walking, Driving.",moving_animation_attribute:"Moving Attribute (Optional)",moving_animation_attribute_help:"The entity attribute to check for the activity value. Defaults to 'activity'."},card:{distance:"Distance",azimuth:"Azimuth",no_home_location:"Center location is not set in Home Assistant and no custom coordinates are provided.",multiple_center_definitions:"Please provide either a zone entity or manual coordinates for the center, not both.",incomplete_center_coords:"Please provide both Center Latitude and Center Longitude.",no_entities:"No entities to show",dialog:{name:"Name",color:"Color",cancel:"Cancel",delete:"Delete",save:"Save"},directions:{N:"N",E:"E",S:"S",W:"W"}}},fr:{editor:{data:"Données",title:"Titre (Optionnel)",auto_radar_max_distance:"Distance max. auto",auto_radar_max_distance_help:"Ajuste automatiquement la distance maximale du radar pour s'adapter à l'entité la plus éloignée. Si désactivé, vous pouvez définir une distance fixe.",radar_max_distance:"Distance max. du radar",center_coords_override:"Remplacer le centre",center_coords_override_help:"Par défaut, le radar est centré sur l'emplacement de votre Home Assistant. Utilisez ceci pour spécifier un point central différent. Le mode 'Statique' utilise une entité de Zone. Le mode 'Mobile' utilise une entité de Personne ou de Suivi d'appareil.",center_modes:{static:"Statique",moving:"Mobile"},center_entity:"Entité centrale (mobile)",location_zone_entity:"Zone centrale (statique)",markers:"Marqueurs (Points d'intérêt)",enable_markers:"Activer les marqueurs",markers_help:"Les marqueurs ne peuvent être activés qu'en mode centre 'Mobile' et sont stockés dans le stockage local de votre navigateur.",clear_all_markers:"Effacer tous les marqueurs en cache",entities:"Entités",entity:"Entité",name:"Nom (Optionnel)",color:"Couleur (Optionnel)",add_entity:"Ajouter une entité",appearance:"Apparence",grid_color:"Couleur de la grille (Optionnel)",font_color:"Couleur de la police (Optionnel)",entity_color:"Couleur par défaut de l'entité (Optionnel)",color_contrast_help:"Pour l'accessibilité, assurez-vous que toutes les couleurs ont un contraste suffisant avec l'arrière-plan de la carte.",show_grid_labels:"Afficher les étiquettes de distance de la grille",legend:"Légende",legend_pulse_help:"Cliquer sur une entité dans la légende fera pulser son point sur le radar, facilitant sa localisation.",show_legend:"Afficher la légende",legend_position:"Position de la légende",legend_positions:{bottom:"Bas",right:"Droite",left:"Gauche"},legend_show_distance:"Afficher la distance dans la légende",animation:"Animation",animation_enabled:"Activer l'animation d'entrée",animation_duration:"Durée de l'animation (ms)",test_animation:"Tester l'animation",moving_animation_enabled:"Activer l'animation de mouvement",moving_animation_enabled_help:"Ajoute une animation de ping de type radar aux entités qui se déplacent actuellement (par ex. marche, conduite). Nécessite que l'entité ait un attribut 'activity'.",moving_animation_activities:"Activités en mouvement (séparées par des virgules)",moving_animation_activities_help:"Liste des activités qui déclenchent l'animation de mouvement. Par défaut : Automotive, Cycling, Walking, Driving.",moving_animation_attribute:"Attribut de mouvement (Optionnel)",moving_animation_attribute_help:"L'attribut de l'entité à vérifier pour la valeur de l'activité. Par défaut : 'activity'."},card:{distance:"Distance",azimuth:"Azimut",no_home_location:"L'emplacement du centre n'est pas défini dans Home Assistant et aucune coordonnée personnalisée n'est fournie.",multiple_center_definitions:"Veuillez fournir soit une entité de zone, soit des coordonnées manuelles pour le centre, mais pas les deux.",incomplete_center_coords:"Veuillez fournir à la fois la latitude et la longitude du centre.",no_entities:"Aucune entité à afficher",dialog:{name:"Nom",color:"Couleur",cancel:"Annuler",delete:"Supprimer",save:"Enregistrer"},directions:{N:"N",E:"E",S:"S",W:"O"}}},pl:{editor:{data:"Ustawienia",title:"Tytuł (opcjonalnie)",auto_radar_max_distance:"Automatyczny zasięg radaru",auto_radar_max_distance_help:"Automatyczne ustawienie maksymalnego zasięgu radaru do najdalszego obiektu. Jeśli jest wyłączone, możesz ustawić stały zasięg.",radar_max_distance:"Maksymalny zasięg radaru (km)",center_coords_override:"Nadpisanie centrum radaru",center_coords_override_help:"Domyślnie centrum radaru wskazuje lokalizację Twojego Home Assistanta. Użyj tej opcji do wskazania innej lokalizacji radaru. Tryb 'Statycznie' używa encji strefowej. Tryb 'W ruchu' używa encji 'Osoba' lub encji śledzącej położenie jej lokalizacji.",center_modes:{static:"Statycznie",moving:"W ruchu"},center_entity:"Środek położenia (W ruchu)",location_zone_entity:"Środek strefy (Statycznie)",markers:"Markery (Interesujące miejsca)",enable_markers:"Włącz markery",markers_help:"Markery mogą być włączone jedynie w trybie 'W ruchu' i są przechowywane w pamięci lokalnej Twojej przeglądarki.",clear_all_markers:"Wyczyść pamięć markerów",entities:"Encje",entity:"Encja",name:"Nazwa (opcjonalna)",color:"Kolor (opcjonalny)",add_entity:"Dodaj encję",appearance:"Wygląd",grid_color:"Kolor siatki radaru (opcjonalny)",font_color:"Kolor czcionki (opcjonalny)",entity_color:"Domyślny kolor encji (opcjonalny)",color_contrast_help:"Sprawdź, czy wszystkie kolory mają kontrast wystarczający dla użytego tła karty.",show_grid_labels:"Pokaż etykiety na siatce radaru",legend:"Legenda",legend_pulse_help:"Kliknięcie encji na legendzie spowoduje jej pulsowanie na obrazie radaru w celu łatwiejszej lokalizacji.",show_legend:"Pokaż legendę",legend_position:"Pozycja legendy",legend_positions:{bottom:"Na dole",right:"Po prawej stronie",left:"Po lewej stronie"},legend_show_distance:"Pokaż odległość na legendzie",animation:"Animacja",animation_enabled:"Włącz animację encji",animation_duration:"Czas trwania animacji (ms)",test_animation:"Testuj animację",moving_animation_enabled:"Włącz animację ruchu",moving_animation_enabled_help:"Włącza animację ping dla encji w ruchu (np. marsz, jazda). Wymaga od encji atrybutu 'aktywność'.",moving_animation_activities:"Aktywności w ruchu (odzielone przecinkami)",moving_animation_activities_help:"Lista aktywności uruchamiających animację ruchu. Domyślne aktywności: Automotive, Rower, Marsz, Samochód.",moving_animation_attribute:"Atrybut ruchu (opcjonalny)",moving_animation_attribute_help:"Atrybut encji, wskazujący wartość aktywności. Domyślny: 'aktywność'."},card:{distance:"Odległość",azimuth:"Azymut",no_home_location:"Środek lokalizacji nie został ustawiony w Home Assistancie i brak jest współrzędnych użytkownika.",multiple_center_definitions:"Wskaż encję strefy albo podaj współrzędne środka. Wybierz tylko jedną z tych możliwości.",incomplete_center_coords:"Podaj współrzędne długości i szerokości geograficznej środka.",no_entities:"Brak encji do wyświetlenia",dialog:{name:"Nazwa",color:"Kolor",cancel:"Anuluj",delete:"Skasuj",save:"Zapisz"},directions:{N:"N",E:"E",S:"S",W:"W"}}}};function Qe(t,e){let n=Je[t];for(const t of e){if("object"!=typeof n||null===n)return;n=n[t]}return"string"==typeof n?n:void 0}function tn(t,e,n={}){const i=t.language||"en",r=e.replace("component.radar-card.","").split("."),a=Qe(i,r)??Qe("en",r);if("string"==typeof a){let t=a;for(const e in n)t=t.replace(`{${e}}`,String(n[e]));return t}return e}var en="http://www.w3.org/1999/xhtml",nn={svg:"http://www.w3.org/2000/svg",xhtml:en,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function rn(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),nn.hasOwnProperty(e)?{space:nn[e],local:t}:t}function an(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===en&&e.documentElement.namespaceURI===en?e.createElement(t):e.createElementNS(n,t)}}function on(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function sn(t){var e=rn(t);return(e.local?on:an)(e)}function ln(){}function cn(t){return null==t?ln:function(){return this.querySelector(t)}}function dn(){return[]}function hn(t){return null==t?dn:function(){return this.querySelectorAll(t)}}function un(t){return function(){return function(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}(t.apply(this,arguments))}}function pn(t){return function(){return this.matches(t)}}function fn(t){return function(e){return e.matches(t)}}var gn=Array.prototype.find;function _n(){return this.firstElementChild}var mn=Array.prototype.filter;function vn(){return Array.from(this.children)}function yn(t){return new Array(t.length)}function bn(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function wn(t,e,n,i,r,a){for(var o,s=0,l=e.length,c=a.length;s<c;++s)(o=e[s])?(o.__data__=a[s],i[s]=o):n[s]=new bn(t,a[s]);for(;s<l;++s)(o=e[s])&&(r[s]=o)}function xn(t,e,n,i,r,a,o){var s,l,c,d=new Map,h=e.length,u=a.length,p=new Array(h);for(s=0;s<h;++s)(l=e[s])&&(p[s]=c=o.call(l,l.__data__,s,e)+"",d.has(c)?r[s]=l:d.set(c,l));for(s=0;s<u;++s)c=o.call(t,a[s],s,a)+"",(l=d.get(c))?(i[s]=l,l.__data__=a[s],d.delete(c)):n[s]=new bn(t,a[s]);for(s=0;s<h;++s)(l=e[s])&&d.get(p[s])===l&&(r[s]=l)}function $n(t){return t.__data__}function kn(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function An(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Mn(t){return function(){this.removeAttribute(t)}}function En(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Cn(t,e){return function(){this.setAttribute(t,e)}}function Sn(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function zn(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Pn(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Nn(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function jn(t){return function(){this.style.removeProperty(t)}}function On(t,e,n){return function(){this.style.setProperty(t,e,n)}}function In(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function Tn(t,e){return t.style.getPropertyValue(e)||Nn(t).getComputedStyle(t,null).getPropertyValue(e)}function Dn(t){return function(){delete this[t]}}function Ln(t,e){return function(){this[t]=e}}function Hn(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function Rn(t){return t.trim().split(/^|\s+/)}function Un(t){return t.classList||new qn(t)}function qn(t){this._node=t,this._names=Rn(t.getAttribute("class")||"")}function Bn(t,e){for(var n=Un(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function Fn(t,e){for(var n=Un(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function Vn(t){return function(){Bn(this,t)}}function Wn(t){return function(){Fn(this,t)}}function Xn(t,e){return function(){(e.apply(this,arguments)?Bn:Fn)(this,t)}}function Kn(){this.textContent=""}function Zn(t){return function(){this.textContent=t}}function Yn(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Gn(){this.innerHTML=""}function Jn(t){return function(){this.innerHTML=t}}function Qn(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function ti(){this.nextSibling&&this.parentNode.appendChild(this)}function ei(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ni(){return null}function ii(){var t=this.parentNode;t&&t.removeChild(this)}function ri(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ai(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function oi(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,a=e.length;i<a;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?e.length=r:delete this.__on}}}function si(t,e,n){return function(){var i,r=this.__on,a=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var o=0,s=r.length;o<s;++o)if((i=r[o]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),void(i.value=e);this.addEventListener(t.type,a,n),i={type:t.type,name:t.name,value:e,listener:a,options:n},r?r.push(i):this.__on=[i]}}function li(t,e,n){var i=Nn(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function ci(t,e){return function(){return li(this,t,e)}}function di(t,e){return function(){return li(this,t,e.apply(this,arguments))}}bn.prototype={constructor:bn,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},qn.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var hi=[null];function ui(t,e){this._groups=t,this._parents=e}function pi(){return new ui([[document.documentElement]],hi)}ui.prototype=pi.prototype={constructor:ui,select:function(t){"function"!=typeof t&&(t=cn(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a,o,s=e[r],l=s.length,c=i[r]=new Array(l),d=0;d<l;++d)(a=s[d])&&(o=t.call(a,a.__data__,d,s))&&("__data__"in a&&(o.__data__=a.__data__),c[d]=o);return new ui(i,this._parents)},selectAll:function(t){t="function"==typeof t?un(t):hn(t);for(var e=this._groups,n=e.length,i=[],r=[],a=0;a<n;++a)for(var o,s=e[a],l=s.length,c=0;c<l;++c)(o=s[c])&&(i.push(t.call(o,o.__data__,c,s)),r.push(o));return new ui(i,r)},selectChild:function(t){return this.select(null==t?_n:function(t){return function(){return gn.call(this.children,t)}}("function"==typeof t?t:fn(t)))},selectChildren:function(t){return this.selectAll(null==t?vn:function(t){return function(){return mn.call(this.children,t)}}("function"==typeof t?t:fn(t)))},filter:function(t){"function"!=typeof t&&(t=pn(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a,o=e[r],s=o.length,l=i[r]=[],c=0;c<s;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&l.push(a);return new ui(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,$n);var n=e?xn:wn,i=this._parents,r=this._groups;"function"!=typeof t&&(t=function(t){return function(){return t}}(t));for(var a=r.length,o=new Array(a),s=new Array(a),l=new Array(a),c=0;c<a;++c){var d=i[c],h=r[c],u=h.length,p=kn(t.call(d,d&&d.__data__,c,i)),f=p.length,g=s[c]=new Array(f),_=o[c]=new Array(f);n(d,h,g,_,l[c]=new Array(u),p,e);for(var m,v,y=0,b=0;y<f;++y)if(m=g[y]){for(y>=b&&(b=y+1);!(v=_[b])&&++b<f;);m._next=v||null}}return(o=new ui(o,i))._enter=s,o._exit=l,o},enter:function(){return new ui(this._enter||this._groups.map(yn),this._parents)},exit:function(){return new ui(this._exit||this._groups.map(yn),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,a=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&(r=e(r))&&(r=r.selection()),null==n?a.remove():n(a),i&&r?i.merge(r).order():r},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,a=i.length,o=Math.min(r,a),s=new Array(r),l=0;l<o;++l)for(var c,d=n[l],h=i[l],u=d.length,p=s[l]=new Array(u),f=0;f<u;++f)(c=d[f]||h[f])&&(p[f]=c);for(;l<r;++l)s[l]=n[l];return new ui(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],a=r.length-1,o=r[a];--a>=0;)(i=r[a])&&(o&&4^i.compareDocumentPosition(o)&&o.parentNode.insertBefore(i,o),o=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=An);for(var n=this._groups,i=n.length,r=new Array(i),a=0;a<i;++a){for(var o,s=n[a],l=s.length,c=r[a]=new Array(l),d=0;d<l;++d)(o=s[d])&&(c[d]=o);c.sort(e)}return new ui(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,a=i.length;r<a;++r){var o=i[r];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,a=e[n],o=0,s=a.length;o<s;++o)(r=a[o])&&t.call(r,r.__data__,o,a);return this},attr:function(t,e){var n=rn(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?En:Mn:"function"==typeof e?n.local?Pn:zn:n.local?Sn:Cn)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?jn:"function"==typeof e?In:On)(t,e,null==n?"":n)):Tn(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Dn:"function"==typeof e?Hn:Ln)(t,e)):this.node()[t]},classed:function(t,e){var n=Rn(t+"");if(arguments.length<2){for(var i=Un(this.node()),r=-1,a=n.length;++r<a;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?Xn:e?Vn:Wn)(n,e))},text:function(t){return arguments.length?this.each(null==t?Kn:("function"==typeof t?Yn:Zn)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Gn:("function"==typeof t?Qn:Jn)(t)):this.node().innerHTML},raise:function(){return this.each(ti)},lower:function(){return this.each(ei)},append:function(t){var e="function"==typeof t?t:sn(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:sn(t),i=null==e?ni:"function"==typeof e?e:cn(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function(){return this.each(ii)},clone:function(t){return this.select(t?ai:ri)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,a=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(t+""),o=a.length;if(!(arguments.length<2)){for(s=e?si:oi,i=0;i<o;++i)this.each(s(a[i],e,n));return this}var s=this.node().__on;if(s)for(var l,c=0,d=s.length;c<d;++c)for(i=0,l=s[c];i<o;++i)if((r=a[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?di:ci)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,r=t[e],a=0,o=r.length;a<o;++a)(i=r[a])&&(yield i)}};var fi={value:()=>{}};function gi(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new _i(i)}function _i(t){this._=t}function mi(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function vi(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=fi,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}_i.prototype=gi.prototype={constructor:_i,on:function(t,e){var n,i,r=this._,a=(i=r,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!i.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),o=-1,s=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=a[o]).type)r[n]=vi(r[n],t.name,e);else if(null==e)for(n in r)r[n]=vi(r[n],t.name,null);return this}for(;++o<s;)if((n=(t=a[o]).type)&&(n=mi(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new _i(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),a=0;a<n;++a)r[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(i=this._[t]).length;a<n;++a)i[a].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,a=i.length;r<a;++r)i[r].value.apply(e,n)}};var yi,bi,wi=0,xi=0,$i=0,ki=0,Ai=0,Mi=0,Ei="object"==typeof performance&&performance.now?performance:Date,Ci="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Si(){return Ai||(Ci(zi),Ai=Ei.now()+Mi)}function zi(){Ai=0}function Pi(){this._call=this._time=this._next=null}function Ni(t,e,n){var i=new Pi;return i.restart(t,e,n),i}function ji(){Ai=(ki=Ei.now())+Mi,wi=xi=0;try{!function(){Si(),++wi;for(var t,e=yi;e;)(t=Ai-e._time)>=0&&e._call.call(void 0,t),e=e._next;--wi}()}finally{wi=0,function(){var t,e,n=yi,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:yi=e);bi=t,Ii(i)}(),Ai=0}}function Oi(){var t=Ei.now(),e=t-ki;e>1e3&&(Mi-=e,ki=t)}function Ii(t){wi||(xi&&(xi=clearTimeout(xi)),t-Ai>24?(t<1/0&&(xi=setTimeout(ji,t-Ei.now()-Mi)),$i&&($i=clearInterval($i))):($i||(ki=Ei.now(),$i=setInterval(Oi,1e3)),wi=1,Ci(ji)))}function Ti(t,e,n){var i=new Pi;return e=null==e?0:+e,i.restart(n=>{i.stop(),t(n+e)},e,n),i}Pi.prototype=Ni.prototype={constructor:Pi,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Si():+n)+(null==e?0:+e),this._next||bi===this||(bi?bi._next=this:yi=this,bi=this),this._call=t,this._time=n,Ii()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ii())}};var Di=gi("start","end","cancel","interrupt"),Li=[];function Hi(t,e,n,i,r,a){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function a(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}function o(a){var c,d,h,u;if(1!==n.state)return l();for(c in r)if((u=r[c]).name===n.name){if(3===u.state)return Ti(o);4===u.state?(u.state=6,u.timer.stop(),u.on.call("interrupt",t,t.__data__,u.index,u.group),delete r[c]):+c<e&&(u.state=6,u.timer.stop(),u.on.call("cancel",t,t.__data__,u.index,u.group),delete r[c])}if(Ti(function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(a))}),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(h=n.tween.length),c=0,d=-1;c<h;++c)(u=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++d]=u);i.length=d+1}}function s(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(l),n.state=5,1),a=-1,o=i.length;++a<o;)i[a].call(t,r);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){for(var i in n.state=6,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=Ni(a,0,n.time)}(t,n,{name:e,index:i,group:r,on:Di,tween:Li,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function Ri(t,e){var n=qi(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Ui(t,e){var n=qi(t,e);if(n.state>3)throw new Error("too late; already running");return n}function qi(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Bi(t,e){var n,i;return function(){var r=Ui(this,t),a=r.tween;if(a!==n)for(var o=0,s=(i=n=a).length;o<s;++o)if(i[o].name===e){(i=i.slice()).splice(o,1);break}r.tween=i}}function Fi(t,e,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var a=Ui(this,t),o=a.tween;if(o!==i){r=(i=o).slice();for(var s={name:e,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=s;break}l===c&&r.push(s)}a.tween=r}}function Vi(t,e,n){var i=t._id;return t.each(function(){var t=Ui(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return qi(t,i).value[e]}}function Wi(t,e){var n;return("number"==typeof e?ue:e instanceof Bt?le:(n=Bt(e))?(e=n,le):_e)(t,e)}function Xi(t){return function(){this.removeAttribute(t)}}function Ki(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Zi(t,e,n){var i,r,a=n+"";return function(){var o=this.getAttribute(t);return o===a?null:o===i?r:r=e(i=o,n)}}function Yi(t,e,n){var i,r,a=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===a?null:o===i?r:r=e(i=o,n)}}function Gi(t,e,n){var i,r,a;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttribute(t))===(s=l+"")?null:o===i&&s===r?a:(r=s,a=e(i=o,l));this.removeAttribute(t)}}function Ji(t,e,n){var i,r,a;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:o===i&&s===r?a:(r=s,a=e(i=o,l));this.removeAttributeNS(t.space,t.local)}}function Qi(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,r)),n}return r._value=e,r}function tr(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,r)),n}return r._value=e,r}function er(t,e){return function(){Ri(this,t).delay=+e.apply(this,arguments)}}function nr(t,e){return e=+e,function(){Ri(this,t).delay=e}}function ir(t,e){return function(){Ui(this,t).duration=+e.apply(this,arguments)}}function rr(t,e){return e=+e,function(){Ui(this,t).duration=e}}var ar=pi.prototype.constructor;function or(t){return function(){this.style.removeProperty(t)}}var sr=0;function lr(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function cr(){return++sr}var dr=pi.prototype;lr.prototype={constructor:lr,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=cn(t));for(var i=this._groups,r=i.length,a=new Array(r),o=0;o<r;++o)for(var s,l,c=i[o],d=c.length,h=a[o]=new Array(d),u=0;u<d;++u)(s=c[u])&&(l=t.call(s,s.__data__,u,c))&&("__data__"in s&&(l.__data__=s.__data__),h[u]=l,Hi(h[u],e,n,u,h,qi(s,n)));return new lr(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=hn(t));for(var i=this._groups,r=i.length,a=[],o=[],s=0;s<r;++s)for(var l,c=i[s],d=c.length,h=0;h<d;++h)if(l=c[h]){for(var u,p=t.call(l,l.__data__,h,c),f=qi(l,n),g=0,_=p.length;g<_;++g)(u=p[g])&&Hi(u,e,n,g,p,f);a.push(p),o.push(l)}return new lr(a,o,e,n)},selectChild:dr.selectChild,selectChildren:dr.selectChildren,filter:function(t){"function"!=typeof t&&(t=pn(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var a,o=e[r],s=o.length,l=i[r]=[],c=0;c<s;++c)(a=o[c])&&t.call(a,a.__data__,c,o)&&l.push(a);return new lr(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,a=Math.min(i,r),o=new Array(i),s=0;s<a;++s)for(var l,c=e[s],d=n[s],h=c.length,u=o[s]=new Array(h),p=0;p<h;++p)(l=c[p]||d[p])&&(u[p]=l);for(;s<i;++s)o[s]=e[s];return new lr(o,this._parents,this._name,this._id)},selection:function(){return new ar(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=cr(),i=this._groups,r=i.length,a=0;a<r;++a)for(var o,s=i[a],l=s.length,c=0;c<l;++c)if(o=s[c]){var d=qi(o,e);Hi(o,t,n,c,s,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new lr(i,this._parents,t,n)},call:dr.call,nodes:dr.nodes,node:dr.node,size:dr.size,empty:dr.empty,each:dr.each,on:function(t,e){var n=this._id;return arguments.length<2?qi(this.node(),n).on.on(t):this.each(function(t,e,n){var i,r,a=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(e)?Ri:Ui;return function(){var o=a(this,t),s=o.on;s!==i&&(r=(i=s).copy()).on(e,n),o.on=r}}(n,t,e))},attr:function(t,e){var n=rn(t),i="transform"===n?Ae:Wi;return this.attrTween(t,"function"==typeof e?(n.local?Ji:Gi)(n,i,Vi(this,"attr."+t,e)):null==e?(n.local?Ki:Xi)(n):(n.local?Yi:Zi)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=rn(t);return this.tween(n,(i.local?Qi:tr)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?ke:Wi;return null==e?this.styleTween(t,function(t,e){var n,i,r;return function(){var a=Tn(this,t),o=(this.style.removeProperty(t),Tn(this,t));return a===o?null:a===n&&o===i?r:r=e(n=a,i=o)}}(t,i)).on("end.style."+t,or(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,r,a;return function(){var o=Tn(this,t),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(t),l=s=Tn(this,t)),o===l?null:o===i&&l===r?a:(r=l,a=e(i=o,s))}}(t,i,Vi(this,"style."+t,e))).each(function(t,e){var n,i,r,a,o="style."+e,s="end."+o;return function(){var l=Ui(this,t),c=l.on,d=null==l.value[o]?a||(a=or(e)):void 0;c===n&&r===d||(i=(n=c).copy()).on(s,r=d),l.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,r,a=n+"";return function(){var o=Tn(this,t);return o===a?null:o===i?r:r=e(i=o,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,function(t,e,n){var i,r;function a(){var a=e.apply(this,arguments);return a!==r&&(i=(r=a)&&function(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}(t,a,n)),i}return a._value=e,a}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Vi(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&function(t){return function(e){this.textContent=t.call(this,e)}}(i)),e}return i._value=t,i}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=qi(this.node(),n).tween,a=0,o=r.length;a<o;++a)if((i=r[a]).name===t)return i.value;return null}return this.each((null==e?Bi:Fi)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?er:nr)(e,t)):qi(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?ir:rr)(e,t)):qi(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){Ui(this,t).ease=e}}(e,t)):qi(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;Ui(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(a,o){var s={value:o},l={value:function(){0===--r&&a()}};n.each(function(){var n=Ui(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e}),0===r&&a()})},[Symbol.iterator]:dr[Symbol.iterator]};var hr={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function ur(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}pi.prototype.interrupt=function(t){return this.each(function(){!function(t,e){var n,i,r,a=t.__transition,o=!0;if(a){for(r in e=null==e?null:e+"",a)(n=a[r]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete a[r]):o=!1;o&&delete t.__transition}}(this,t)})},pi.prototype.transition=function(t){var e,n;t instanceof lr?(e=t._id,t=t._name):(e=cr(),(n=hr).time=Si(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,a=0;a<r;++a)for(var o,s=i[a],l=s.length,c=0;c<l;++c)(o=s[c])&&Hi(o,t,e,c,s,n||ur(o,e));return new lr(i,this._parents,t,e)};const pr=s`.card-content{padding:16px}.card-content.flex-layout{align-items:center;display:flex;gap:16px;padding:8px}.card-content.legend-left .legend{order:-1}.warning{color:var(--error-color)}.radar-chart-container{align-items:center;display:flex;flex-shrink:0;justify-content:center;position:relative}.legend-left .radar-chart-container,.legend-right .radar-chart-container{width:50%}.legend-left .radar-chart,.legend-right .radar-chart{align-items:center;display:flex}ha-fab.add-marker-btn{--mdc-theme-primary: var(--secondary-text-color) !important;--mdc-theme-secondary: var(--secondary-text-color) !important;bottom:8px;position:absolute;right:8px;z-index:1}ha-fab.add-marker-btn.fade-in{animation-fill-mode:forwards;animation-name:fadeIn;animation-timing-function:ease-in-out;opacity:0}.radar-chart{height:220px;position:relative;width:220px}.radar-chart svg{display:block;position:relative}.custom-tooltip{background-color:var(--ha-card-background, var(--card-background-color, white));border:1px solid var(--divider-color);border-radius:var(--ha-card-border-radius, 4px);box-shadow:0 2px 5px rgba(0,0,0,.2);font-size:12px;left:0;line-height:1.4;max-width:220px;opacity:0;overflow-wrap:break-word;padding:8px;pointer-events:none;position:absolute;top:0;transition:opacity .2s ease-in-out;visibility:hidden;z-index:1000}.custom-tooltip.visible{opacity:1;visibility:visible}.custom-tooltip strong{color:var(--primary-text-color)}.no-entities{padding:16px;text-align:center}@keyframes pulse{0%{opacity:.7;transform:scale(1.2)}50%{opacity:1;transform:scale(2.2)}100%{opacity:.7;transform:scale(1.2)}}.entity-group.pulsing .entity-dot{animation:pulse 1.5s infinite}.entity-dot{transform-box:fill-box;transform-origin:center}.entity-dot[d]{stroke:var(--ha-card-background, var(--card-background-color, white));stroke-width:.5px;transform:rotate(0);transform-origin:center}.entity-dot:focus-visible{stroke:var(--accent-color);stroke-width:1.5px}@keyframes radar-ping{0%{r:3;stroke-opacity:.8;stroke-width:3px}100%{r:30;stroke-opacity:0;stroke-width:0}}.legend{display:flex;gap:8px}.legend.bottom{flex-wrap:wrap;gap:8px 16px;justify-content:center;margin-top:16px}.legend.left,.legend.right{align-items:flex-start;flex-direction:column;flex-grow:1;max-height:220px;overflow-y:auto;pointer-events:auto}.legend.fade-in{animation-fill-mode:forwards;animation-name:fadeIn;animation-timing-function:ease-in-out;opacity:0}@keyframes fadeIn{to{opacity:1}}.legend-item{align-items:center;background:rgba(0,0,0,0);border:none;border-radius:4px;color:inherit;cursor:pointer;display:flex;font-family:inherit;font-size:inherit;gap:8px;padding:2px 4px;text-align:inherit;transition:background-color .3s ease}.legend-item:focus-visible{outline:2px solid var(--accent-color);outline-offset:2px}.legend-item:hover{background-color:color-mix(in srgb, var(--secondary-text-color) 10%, transparent)}.legend-item.active{background-color:color-mix(in srgb, var(--accent-color) 20%, transparent)}.legend-color{border-radius:50%;flex-shrink:0;height:12px;width:12px}.legend-marker{border-bottom:10px solid;border-left:6px solid rgba(0,0,0,0);border-right:6px solid rgba(0,0,0,0);flex-shrink:0;height:0;width:0}.legend-text-container{color:var(--secondary-text-color);font-size:12px}.legend-name{display:inline-block;max-width:130px;overflow:hidden;text-overflow:ellipsis;vertical-align:middle;white-space:nowrap}.legend-distance{font-style:italic}.entity-ping{animation:radar-ping 2s ease-out infinite;fill:none;pointer-events:none;transform-origin:center}.entity-dot:focus-visible{stroke:var(--accent-color);stroke-width:1.5px}ha-dialog{--mdc-dialog-max-width: 400px}.dialog-content{display:flex;flex-direction:column;gap:16px}ha-dialog.dialog-actions{--justify-action-buttons: space-between;--mdc-dialog-action-button-spacing: 4px}.color-picker-wrapper{display:flex;flex-direction:column;gap:8px}.warning{--mdc-theme-primary: var(--error-color);margin:0}ha-dialog mwc-button{--mdc-theme-primary: var(--primary-text-color);--mdc-button-outline-color: transparent;background-color:rgba(var(--rgb-primary-text-color), 0.05);border-radius:5px;cursor:pointer;display:inline-block;padding:5px 10px}`,fr=(t,e=0,n=1)=>t>n?n:t<e?e:t,gr=(t,e=0,n=Math.pow(10,e))=>Math.round(n*t)/n,_r=t=>("#"===t[0]&&(t=t.substring(1)),t.length<6?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:4===t.length?gr(parseInt(t[3]+t[3],16)/255,2):1}:{r:parseInt(t.substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16),a:8===t.length?gr(parseInt(t.substring(6,8),16)/255,2):1}),mr=t=>{const{h:e,s:n,l:i}=(({h:t,s:e,v:n,a:i})=>{const r=(200-e)*n/100;return{h:gr(t),s:gr(r>0&&r<200?e*n/100/(r<=100?r:200-r)*100:0),l:gr(r/2),a:gr(i,2)}})(t);return`hsl(${e}, ${n}%, ${i}%)`},vr=({h:t,s:e,v:n,a:i})=>{t=t/360*6,e/=100,n/=100;const r=Math.floor(t),a=n*(1-e),o=n*(1-(t-r)*e),s=n*(1-(1-t+r)*e),l=r%6;return{r:gr(255*[n,o,a,a,s,n][l]),g:gr(255*[s,n,n,o,a,a][l]),b:gr(255*[a,a,s,n,n,o][l]),a:gr(i,2)}},yr=t=>{const e=t.toString(16);return e.length<2?"0"+e:e},br=({r:t,g:e,b:n,a:i})=>{const r=i<1?yr(gr(255*i)):"";return"#"+yr(t)+yr(e)+yr(n)+r},wr=({r:t,g:e,b:n,a:i})=>{const r=Math.max(t,e,n),a=r-Math.min(t,e,n),o=a?r===t?(e-n)/a:r===e?2+(n-t)/a:4+(t-e)/a:0;return{h:gr(60*(o<0?o+6:o)),s:gr(r?a/r*100:0),v:gr(r/255*100),a:i}},xr=(t,e)=>{if(t===e)return!0;for(const n in t)if(t[n]!==e[n])return!1;return!0},$r={},kr=t=>{let e=$r[t];return e||(e=document.createElement("template"),e.innerHTML=t,$r[t]=e),e},Ar=(t,e,n)=>{t.dispatchEvent(new CustomEvent(e,{bubbles:!0,detail:n}))};let Mr=!1;const Er=t=>"touches"in t,Cr=(t,e)=>{const n=Er(e)?e.touches[0]:e,i=t.el.getBoundingClientRect();Ar(t.el,"move",t.getMove({x:fr((n.pageX-(i.left+window.pageXOffset))/i.width),y:fr((n.pageY-(i.top+window.pageYOffset))/i.height)}))};class Sr{constructor(t,e,n,i){const r=kr(`<div role="slider" tabindex="0" part="${e}" ${n}><div part="${e}-pointer"></div></div>`);t.appendChild(r.content.cloneNode(!0));const a=t.querySelector(`[part=${e}]`);a.addEventListener("mousedown",this),a.addEventListener("touchstart",this),a.addEventListener("keydown",this),this.el=a,this.xy=i,this.nodes=[a.firstChild,a]}set dragging(t){const e=t?document.addEventListener:document.removeEventListener;e(Mr?"touchmove":"mousemove",this),e(Mr?"touchend":"mouseup",this)}handleEvent(t){switch(t.type){case"mousedown":case"touchstart":if(t.preventDefault(),!(t=>!(Mr&&!Er(t)||(Mr||(Mr=Er(t)),0)))(t)||!Mr&&0!=t.button)return;this.el.focus(),Cr(this,t),this.dragging=!0;break;case"mousemove":case"touchmove":t.preventDefault(),Cr(this,t);break;case"mouseup":case"touchend":this.dragging=!1;break;case"keydown":((t,e)=>{const n=e.keyCode;n>40||t.xy&&n<37||n<33||(e.preventDefault(),Ar(t.el,"move",t.getMove({x:39===n?.01:37===n?-.01:34===n?.05:33===n?-.05:35===n?1:36===n?-1:0,y:40===n?.01:38===n?-.01:0},!0)))})(this,t)}}style(t){t.forEach((t,e)=>{for(const n in t)this.nodes[e].style.setProperty(n,t[n])})}}class zr extends Sr{constructor(t){super(t,"hue",'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"',!1)}update({h:t}){this.h=t,this.style([{left:t/360*100+"%",color:mr({h:t,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuenow",`${gr(t)}`)}getMove(t,e){return{h:e?fr(this.h+360*t.x,0,360):360*t.x}}}class Pr extends Sr{constructor(t){super(t,"saturation",'aria-label="Color"',!0)}update(t){this.hsva=t,this.style([{top:100-t.v+"%",left:`${t.s}%`,color:mr(t)},{"background-color":mr({h:t.h,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuetext",`Saturation ${gr(t.s)}%, Brightness ${gr(t.v)}%`)}getMove(t,e){return{s:e?fr(this.hsva.s+100*t.x,0,100):100*t.x,v:e?fr(this.hsva.v-100*t.y,0,100):Math.round(100-100*t.y)}}}const Nr=Symbol("same"),jr=Symbol("color"),Or=Symbol("hsva"),Ir=Symbol("update"),Tr=Symbol("parts"),Dr=Symbol("css"),Lr=Symbol("sliders");class Hr extends HTMLElement{static get observedAttributes(){return["color"]}get[Dr](){return[':host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none!important}[role=slider]{position:relative;touch-action:none;user-select:none;-webkit-user-select:none;outline:0}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;display:flex;place-content:center center;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{content:"";width:100%;height:100%;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%,-50%) scale(1.1)}',"[part=hue]{flex:0 0 24px;background:linear-gradient(to right,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red 100%)}[part=hue-pointer]{top:50%;z-index:2}","[part=saturation]{flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top,#000,transparent),linear-gradient(to right,#fff,rgba(255,255,255,0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}"]}get[Lr](){return[Pr,zr]}get color(){return this[jr]}set color(t){if(!this[Nr](t)){const e=this.colorModel.toHsva(t);this[Ir](e),this[jr]=t}}constructor(){super();const t=kr(`<style>${this[Dr].join("")}</style>`),e=this.attachShadow({mode:"open"});e.appendChild(t.content.cloneNode(!0)),e.addEventListener("move",this),this[Tr]=this[Lr].map(t=>new t(e))}connectedCallback(){if(this.hasOwnProperty("color")){const t=this.color;delete this.color,this.color=t}else this.color||(this.color=this.colorModel.defaultColor)}attributeChangedCallback(t,e,n){const i=this.colorModel.fromAttr(n);this[Nr](i)||(this.color=i)}handleEvent(t){const e=this[Or],n={...e,...t.detail};let i;this[Ir](n),xr(n,e)||this[Nr](i=this.colorModel.fromHsva(n))||(this[jr]=i,Ar(this,"color-changed",{value:i}))}[Nr](t){return this.color&&this.colorModel.equal(t,this.color)}[Ir](t){this[Or]=t,this[Tr].forEach(e=>e.update(t))}}const Rr={defaultColor:"#000",toHsva:t=>wr(_r(t)),fromHsva:({h:t,s:e,v:n})=>br(vr({h:t,s:e,v:n,a:1})),equal:(t,e)=>t.toLowerCase()===e.toLowerCase()||xr(_r(t),_r(e)),fromAttr:t=>t};class Ur extends Hr{get colorModel(){return Rr}}const qr=(t,e,n,i)=>{const r=new CustomEvent(e,{bubbles:!0,cancelable:!1,composed:!0,...i,detail:n});t.dispatchEvent(r)};function Br(t){return t*Math.PI/180}function Fr(t,e,n,i,r){const a="km"===r?6371:3959,o=Br(n-t),s=Br(i-e),l=Math.sin(o/2)*Math.sin(o/2)+Math.cos(Br(t))*Math.cos(Br(n))*Math.sin(s/2)*Math.sin(s/2);return a*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))}function Vr(t,e,n,i){const r=Br(i-e),a=Math.sin(r)*Math.cos(Br(n)),o=Math.cos(Br(t))*Math.sin(Br(n))-Math.sin(Br(t))*Math.cos(Br(n))*Math.cos(r);let s=180*Math.atan2(a,o)/Math.PI;return s=(s+360)%360,s}function Wr(t,e,n){if("km"===e&&t<1)return`${Math.round(1e3*t)} m`;if("mi"===e&&t<1)return`${Math.round(5280*t)} ft`;const i=t.toFixed(2);return n?.removeIntegerDecimals&&i.endsWith(".00")?`${t.toFixed(0)} ${e}`:`${i} ${e}`}window.customElements.get("hex-color-picker")||window.customElements.define("hex-color-picker",class extends Ur{});const Xr="radar-card",Kr=`${Xr}-editor`,Zr="radar-card-markers";let Yr=class extends st{constructor(){super(...arguments),this.editMode=!1,this._points=[],this._markers=[],this._tooltip={visible:!1,content:V,x:0,y:0},this._pulsingEntityId=null,this._error=null,this._editingMarker=null,this._hasAnimated=!1,this._isTestingAnimation=!1,this._runTestAnimation=()=>{if(this.editMode&&!1!==this._config.animation_enabled){this._renderRadarChart(this._points,!0),this._isTestingAnimation=!0;const t=this._config.animation_duration??750;setTimeout(()=>{this._isTestingAnimation=!1},t+100)}},this._boundMarkersUpdatedHandler=()=>{this._config&&this.hass&&(this._loadMarkers(),this._calculatePoints(),this.requestUpdate())}}setConfig(t){if(!t||!t.entities||!Array.isArray(t.entities)||0===t.entities.length&&!t.enable_markers)throw new Error("You need to define at least one entity or enable markers");this._config=t,this._loadMarkers()}static async getConfigElement(){const t=window.loadCardHelpers;if(!t)throw new Error("This card requires Home Assistant 2023.4+ and `loadCardHelpers` is not available.");const e=await t(),n=await e.createCardElement({type:"entities",entities:[]});return await n.constructor.getConfigElement(),await Promise.resolve().then(function(){return Qr}),document.createElement(Kr)}static getStubConfig(){return{entities:["device_tracker.your_device"]}}getCardSize(){return 3}async _showTooltip(t,e,n){const i=this._getPointTooltipContent(e,n);this._tooltip={...this._tooltip,visible:!0,content:i},await this.updateComplete,this._moveTooltip(t)}_getPointTooltipContent(t,e){const n=Wr(t.distance,e);return B`
      <strong>${t.name||t.entity_id}</strong><br />
      ${tn(this.hass,"component.radar-card.card.distance")}: ${n}<br />
      ${tn(this.hass,"component.radar-card.card.azimuth")}: ${Math.round(t.azimuth)}°
    `}_getPointAccessibleLabel(t,e){const n=Wr(t.distance,e);return`${t.name||t.entity_id}. ${tn(this.hass,"component.radar-card.card.distance")}: ${n}. ${tn(this.hass,"component.radar-card.card.azimuth")}: ${Math.round(t.azimuth)}°.`}_moveTooltip(t){if(!this._tooltip.visible)return;const e=this.shadowRoot?.querySelector(".custom-tooltip");if(!e)return;const n=this.shadowRoot?.querySelector(".radar-chart-container");if(!n)return;const i=n.getBoundingClientRect(),{clientX:r}=t,{clientY:a}=t,o=r-i.left,s=a-i.top,l=e.offsetWidth,c=e.offsetHeight,d=o>i.width/2?-l-5:5;let h=-c-5;s+h<0&&(h=15),this._tooltip={...this._tooltip,x:o+d,y:s+h}}_hideTooltip(){this._tooltip.visible&&(this._tooltip={...this._tooltip,visible:!1,content:V})}_handleLegendItemClick(t){t.entity_id&&(this._pulsingEntityId===t.entity_id?this._pulsingEntityId=null:this._pulsingEntityId=t.entity_id)}_loadMarkers(){try{const t=localStorage.getItem(Zr);this._markers=t?JSON.parse(t):[]}catch(t){console.error("RadarCard: Failed to load markers from localStorage",t),this._markers=[]}}_saveMarkers(t){try{const e=[...this._markers];if(t){const n=e.findIndex(e=>e.id===t.id);n>-1?e[n]=t:e.push(t),this._markers=e}localStorage.setItem(Zr,JSON.stringify(this._markers)),this._calculatePoints(),this.requestUpdate(),window.dispatchEvent(new CustomEvent("radar-card-markers-updated"))}catch(t){console.error("RadarCard: Failed to save markers to localStorage",t)}}_deleteMarker(t){this._markers=this._markers.filter(e=>e.id!==t),this._saveMarkers()}_handleMarkerClick(t){t.isMarker&&t.entity_id&&(this._editingMarker=this._markers.find(e=>`marker.${e.id}`===t.entity_id)||null)}_handleMarkerDialogSave(){this._editingMarker&&(this._saveMarkers(this._editingMarker),this._editingMarker=null)}_handleMarkerDialogInput(t){if(!this._editingMarker)return;const e=t.target,n=e.name;let i;i="detail"in e?e.detail.value:e.value,this._editingMarker={...this._editingMarker,[n]:i}}_handleMarkerDialogCancel(){this._editingMarker=null}_handleMarkerDialogDelete(){this._editingMarker&&(this._deleteMarker(this._editingMarker.id),this._editingMarker=null)}_addMarker(){if(!this._config.center_entity)return;const t=this._getCoordsFromState(this._config.center_entity);if(!t)return;const e=new Date;this._editingMarker={id:e.toISOString(),latitude:t.lat,longitude:t.lon,name:`Marker ${e.toLocaleDateString()} ${e.toLocaleTimeString()}`}}_renderRadarChart(t,e=!1){const n=this.shadowRoot?.querySelector(".radar-chart");if(!n)return;const i=Math.min(220,220)/2-20,r=this.hass.config.unit_system.length||"km",a=this._config.animation_duration??750,o=!1!==this._config.auto_radar_max_distance?function(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}(t,t=>t.distance)??100:this._config.radar_max_distance??100,s=Ye().domain([0,o]).range([0,i]),l=function(t){return"string"==typeof t?new ui([[document.querySelector(t)]],[document.documentElement]):new ui([[t]],hi)}(n).selectAll("svg").data([null]).join("svg").attr("viewBox","0 0 220 220").attr("role","img").attr("aria-describedby","radar-desc");l.selectAll("desc").data([null]).join("desc").attr("id","radar-desc").text(`Showing ${t.length} entities. The center is your location. Entities are plotted by distance and direction.`);const c=l.selectAll("g.radar-main-group").data([null]).join("g").attr("class","radar-main-group").attr("transform","translate(110, 110)"),d=s.ticks(4).slice(1),h=c.selectAll(".grid-circle").data(d).join(t=>t.append("circle").attr("class","grid-circle").style("fill","none"),t=>t,t=>t.remove());if(e?h.attr("r",0).transition().duration(a).ease(Ge).attr("r",t=>s(t)):h.attr("r",t=>s(t)),h.style("stroke",this._config.grid_color??"var(--primary-text-color)").style("opacity",.3),!1!==this._config.show_grid_labels){const t=d.map(t=>Wr(t,r,{removeIntegerDecimals:!0})),n=t.map(t=>t.split(" ")[1]),i=c.selectAll(".grid-label").data(d).join("text").attr("class","grid-label").attr("x",4).attr("dy","-0.2em").style("text-anchor","start").style("fill",this._config.font_color??this._config.grid_color??"var(--primary-text-color)").text((e,i)=>{const r=t[i];return i<d.length-1&&n[i]===n[i+1]?r.split(" ")[0]:r});e?i.attr("y",0).style("opacity",0).style("font-size","0px").transition().duration(a).ease(Ge).attr("y",t=>-s(t)).style("opacity",.7).style("font-size","8px"):i.attr("y",t=>-s(t)).style("opacity",.7).style("font-size","8px")}else c.selectAll(".grid-label").remove();const u=[{label:tn(this.hass,"component.radar-card.card.directions.N"),angle:0},{label:tn(this.hass,"component.radar-card.card.directions.E"),angle:90},{label:tn(this.hass,"component.radar-card.card.directions.S"),angle:180},{label:tn(this.hass,"component.radar-card.card.directions.W"),angle:270}],p=c.selectAll(".cardinal-line").data(u).join("line").attr("class","cardinal-line").style("stroke",this._config.grid_color??"var(--primary-text-color)").attr("x1",0).attr("y1",0);e?p.attr("x2",0).attr("y2",0).style("opacity",0).transition().duration(a).ease(Ge).attr("x2",t=>s(o)*Math.cos((t.angle-90)*(Math.PI/180))).attr("y2",t=>s(o)*Math.sin((t.angle-90)*(Math.PI/180))).style("opacity",.3):p.attr("x2",t=>s(o)*Math.cos((t.angle-90)*(Math.PI/180))).attr("y2",t=>s(o)*Math.sin((t.angle-90)*(Math.PI/180))).style("opacity",.3);const f=c.selectAll(".cardinal-label").data(u).join("text").attr("class","cardinal-label").text(t=>t.label).style("text-anchor","middle").style("dominant-baseline","middle").style("fill",this._config.font_color??this._config.grid_color??"var(--primary-text-color)");e?f.attr("x",0).attr("y",0).style("opacity",0).style("font-size","0px").transition().duration(a).ease(Ge).attr("x",t=>(s(o)+10)*Math.cos((t.angle-90)*(Math.PI/180))).attr("y",t=>(s(o)+10)*Math.sin((t.angle-90)*(Math.PI/180))).style("opacity",1).style("font-size","10px"):f.attr("x",t=>(s(o)+10)*Math.cos((t.angle-90)*(Math.PI/180))).attr("y",t=>(s(o)+10)*Math.sin((t.angle-90)*(Math.PI/180))).style("opacity",1).style("font-size","10px");const g=c.selectAll("circle.entity-ping").data(t.filter(t=>t.isMoving&&!0===this._config.moving_animation_enabled),(t,e)=>t.entity_id||t.name||e).join(t=>t.insert("circle","circle.entity-dot").attr("class","entity-ping"),t=>t,t=>t.remove()).style("stroke",t=>t.color||this._config.entity_color||"var(--info-color)");g.attr("transform","translate(0,0)");const _=c.selectAll("g.entity-group").data(t,(t,e)=>t.entity_id||t.name||e).join(t=>t.append("g").attr("class","entity-group").call(t=>t.append(t=>document.createElementNS("http://www.w3.org/2000/svg",t.isMarker?"path":"circle")).attr("class","entity-dot")).call(t=>t.append("title")),t=>t,t=>t.remove());_.attr("transform","translate(0,0)"),_.select("title").text(t=>this._getPointAccessibleLabel(t,r)),_.attr("tabindex",0).attr("class",t=>"entity-group "+(t.entity_id===this._pulsingEntityId?"pulsing":"")).style("fill",t=>t.color||this._config.entity_color||"var(--info-color)").style("fill-opacity",1).attr("d",t=>t.isMarker?"M0,-4L4,4H-4Z":"").style("cursor","pointer").on("mouseover",(t,e)=>{this._showTooltip(t,e,r)}).on("focus",(t,e)=>{this._showTooltip(t,e,r)}).on("mousemove",t=>{this._moveTooltip(t)}).on("mouseout",()=>this._hideTooltip()).on("blur",()=>this._hideTooltip()),_.filter(".pulsing").raise();const m=_.filter(t=>!0!==t.isMarker).select(".entity-dot"),v=_.filter(t=>!0===t.isMarker).select(".entity-dot");m.attr("r",3),v.attr("d","M0,-4L4,4H-4Z");const y=_.filter(t=>!t.isMarker),b=_.filter(t=>!!t.isMarker);e?(y.select(".entity-dot").attr("cx",0).attr("cy",0).transition().duration(a).ease(Ge).attr("cx",t=>s(t.distance)*Math.cos((t.azimuth-90)*(Math.PI/180))).attr("cy",t=>s(t.distance)*Math.sin((t.azimuth-90)*(Math.PI/180))),b.attr("transform","translate(0,0)").transition().duration(a).ease(Ge).attr("transform",t=>`translate(${s(t.distance)*Math.cos((t.azimuth-90)*(Math.PI/180))}, ${s(t.distance)*Math.sin((t.azimuth-90)*(Math.PI/180))})`),b.select(".entity-dot").attr("transform",t=>`rotate(${t.azimuth})`),g.attr("cx",0).attr("cy",0).transition().duration(a).ease(Ge).attr("transform",()=>"translate(0, 0)").attr("cx",t=>s(t.distance)*Math.cos((t.azimuth-90)*(Math.PI/180))).attr("cy",t=>s(t.distance)*Math.sin((t.azimuth-90)*(Math.PI/180)))):(y.select(".entity-dot").attr("transform",null),y.select(".entity-dot").attr("cx",t=>s(t.distance)*Math.cos((t.azimuth-90)*(Math.PI/180))),y.select(".entity-dot").attr("cy",t=>s(t.distance)*Math.sin((t.azimuth-90)*(Math.PI/180))),b.attr("transform",t=>`translate(${s(t.distance)*Math.cos((t.azimuth-90)*(Math.PI/180))}, ${s(t.distance)*Math.sin((t.azimuth-90)*(Math.PI/180))})`),b.select(".entity-dot").attr("transform",t=>`rotate(${t.azimuth})`),g.attr("cx",t=>s(t.distance)*Math.cos((t.azimuth-90)*(Math.PI/180))).attr("cy",t=>s(t.distance)*Math.sin((t.azimuth-90)*(Math.PI/180)))),_.on("click",(t,e)=>{e.entity_id&&!e.isMarker?qr(this,"hass-more-info",{entityId:e.entity_id}):e.isMarker&&this._handleMarkerClick(e)})}_renderLegend(t=!1){const e=this._config.legend_position??"bottom",n=!1!==this._config.legend_show_distance,i=this.hass.config.unit_system.length||"km",r=this._config.animation_duration??750;return B`
      <div class="legend ${e} ${t?"fade-in":""}" style=${t?`animation-duration: ${r}ms; animation-delay: ${.25*r}ms`:""}>
        ${this._points.map(t=>B`
            <button
              type="button"
              class="legend-item ${t.entity_id===this._pulsingEntityId?"active":""}"
              aria-pressed="${t.entity_id===this._pulsingEntityId}"
              aria-label="Toggle pulse for ${t.name}"
              @click=${()=>this._handleLegendItemClick(t)}
            >
              ${t.isMarker?B`<span
                    class="legend-marker"
                    style="border-bottom-color: ${t.color||this._config.entity_color||"var(--info-color)"}"
                  ></span>`:B`<span
                    class="legend-color"
                    style="background-color: ${t.color||this._config.entity_color||"var(--info-color)"}"
                  ></span>`}
              <div class="legend-text-container ${n?"":"no-distance"}">
                <span class="legend-name">${t.name}</span>${n?B` <span class="legend-distance">(${Wr(t.distance,i)})</span>`:V}
              </div>
            </button>
          `)}
      </div>
    `}_renderMarkerDialog(){if(!this._editingMarker)return B``;const t=this._editingMarker.name||"",e=this._editingMarker.color||"";return B`
      <ha-dialog open @closed=${this._handleMarkerDialogCancel} .heading=${t} class="dialog-actions">
        <div class="dialog-content">
          <ha-textfield
            label=${tn(this.hass,"component.radar-card.card.dialog.name")}
            name="name"
            .value=${t}
            @input=${this._handleMarkerDialogInput}
          ></ha-textfield>
          <div class="color-picker-wrapper">
            <ha-textfield
              label=${tn(this.hass,"component.radar-card.card.dialog.color")}
              name="color"
              .value=${e}
              placeholder="e.g., #ff0000"
              @input=${this._handleMarkerDialogInput}
            ></ha-textfield>
            <hex-color-picker
              .color=${e||"#000000"}
              @color-changed=${t=>{this._editingMarker={...this._editingMarker,color:t.detail.value},this.requestUpdate("_editingMarker")}}
            ></hex-color-picker>
          </div>
        </div>
        <mwc-button class="warning" @click=${this._handleMarkerDialogDelete} slot="secondaryAction" unelevated>
          ${tn(this.hass,"component.radar-card.card.dialog.delete")}
        </mwc-button>
        <mwc-button @click=${this._handleMarkerDialogCancel} slot="secondaryAction" unelevated>
          ${tn(this.hass,"component.radar-card.card.dialog.cancel")}
        </mwc-button>
        <mwc-button @click=${this._handleMarkerDialogSave} slot="primaryAction" unelevated>
          ${tn(this.hass,"component.radar-card.card.dialog.save")}
        </mwc-button>
      </ha-dialog>
    `}_calculatePoints(){if(!this._config||!this.hass||!this.hass.config)return;let t,e;const n=this._config.center_entity&&"string"==typeof this._config.center_entity?this._getCoordsFromState(this._config.center_entity):null,i=this._config.location_zone_entity&&"string"==typeof this._config.location_zone_entity?this._getCoordsFromState(this._config.location_zone_entity):null;if(n?(t=n.lat,e=n.lon):i?(t=i.lat,e=i.lon):null!=this._config.center_latitude&&null!=this._config.center_longitude?(t=this._config.center_latitude,e=this._config.center_longitude):(t=this.hass.config.latitude,e=this.hass.config.longitude),void 0===t||void 0===e)return;const r={lat:t,lon:e},a=this._config.entities.map(t=>"string"==typeof t?{entity:t}:t).map(t=>{const e=t.entity,n=this.hass.states[e];if(!n||null==n.attributes.latitude||null==n.attributes.longitude)return null;const i=this._config.moving_animation_activities||["Automotive","Cycling","Walking","Driving"],a=this._config.moving_animation_attribute||"activity",o=n.attributes[a],s="string"==typeof o&&i.map(t=>t.toLowerCase()).includes(o.toLowerCase());return{distance:Fr(r.lat,r.lon,n.attributes.latitude,n.attributes.longitude,this.hass.config.unit_system.length),azimuth:Vr(r.lat,r.lon,n.attributes.latitude,n.attributes.longitude),name:t.name||n.attributes.friendly_name||e,entity_id:e,color:t.color,isMoving:s}}).filter(t=>null!==t),o=this._config.enable_markers?this._markers.map(t=>({distance:Fr(r.lat,r.lon,t.latitude,t.longitude,this.hass.config.unit_system.length),azimuth:Vr(r.lat,r.lon,t.latitude,t.longitude),name:t.name,entity_id:`marker.${t.id}`,color:t.color||"var(--warning-color)",isMarker:!0})):[];this._points=[...a,...o]}_getCoordsFromState(t){const e=this.hass.states[t];if(!e)return null;const n=e.attributes.latitude,i=e.attributes.longitude;return"number"==typeof n&&"number"==typeof i?{lat:n,lon:i}:(console.warn(`Radar-card: Entity '${t}' does not have valid latitude and longitude attributes.`),null)}render(){if(!this._config||!this.hass)return B``;if(this._error)return B`
        <ha-card .header=${this._config.title}>
          <div class="card-content warning">${this._error}</div>
        </ha-card>
      `;if(0===this._points.length)return B`
        <ha-card .header=${this._config.title}>
          <div class="card-content">
            <div class="no-entities">${tn(this.hass,"component.radar-card.card.no_entities")}</div>
          </div>
        </ha-card>
      `;const t=this._config.legend_position||"bottom",e=!1!==this._config.show_legend,n=!1!==this._config.animation_enabled&&!this.editMode&&!this._hasAnimated&&this._points.length>0||this.editMode&&this._isTestingAnimation,i=e?this._renderLegend(n):V,r=["left","right"].includes(t),a="bottom"===t,o=this._config.enable_markers&&this._config.center_entity,s=this._config.animation_duration??750,l=n?`animation-duration: ${s}ms; animation-delay: ${.25*s}ms`:"",c=B`
      <div class="radar-chart-container" @mousemove=${this._moveTooltip}>
        <div class="radar-chart"></div>
        ${this._tooltip.visible?B`<div class="custom-tooltip visible" style="left: ${this._tooltip.x}px; top: ${this._tooltip.y}px;">
              ${this._tooltip.content}
            </div>`:""}
        ${o?B`<ha-fab
              mini
              class="add-marker-btn ${n?"fade-in":""}"
              style=${l}
              @click=${this._addMarker}
              title="Add Marker at Current Location"
              role="button"
              aria-label="Add Marker at Current Location"
            >
              <ha-icon slot="icon" icon="mdi:map-marker-plus"></ha-icon>
            </ha-fab>`:V}
      </div>
    `;return B`
      <ha-card .header=${this._config.title}>
        <div class="card-content ${r?`flex-layout legend-${t}`:""}">
          ${c} ${r||a?i:V}
        </div>
        ${this._renderMarkerDialog()}
      </ha-card>
    `}connectedCallback(){super.connectedCallback(),this._loadMarkers(),window.addEventListener("radar-card-test-animation",this._runTestAnimation),window.addEventListener("radar-card-markers-updated",this._boundMarkersUpdatedHandler)}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("radar-card-test-animation",this._runTestAnimation),window.removeEventListener("radar-card-markers-updated",this._boundMarkersUpdatedHandler),this._hasAnimated=!1}willUpdate(t){if(super.willUpdate(t),this._config&&this.hass&&this.hass.config&&(t.has("hass")||t.has("_config"))){if(null!=this._config.center_latitude&&null==this._config.center_longitude||null==this._config.center_latitude&&null!=this._config.center_longitude)return void(this._error=tn(this.hass,"component.radar-card.card.incomplete_center_coords"));if(this._config.location_zone_entity&&(this._config.center_latitude||this._config.center_longitude))return void(this._error=tn(this.hass,"component.radar-card.card.multiple_center_definitions"));this._error=null;let t=!1;if(this._config.center_entity){if(!this._getCoordsFromState(this._config.center_entity))return void(this._error=`Center entity '${this._config.center_entity}' is invalid or has no location.`);t=!0}else(this._config.location_zone_entity&&this._getCoordsFromState(this._config.location_zone_entity)||null!=this._config.center_latitude&&null!=this._config.center_longitude||null!=this.hass.config?.latitude&&null!=this.hass.config?.longitude)&&(t=!0);if(!t)return void(this._error=tn(this.hass,"component.radar-card.card.no_home_location"));this._calculatePoints()}}updated(t){if(super.updated(t),this._config&&this.hass){if(1===t.size&&t.has("_isTestingAnimation"))return;const e=!1!==this._config.animation_enabled&&!this.editMode&&!this._hasAnimated&&this._points.length>0;this._renderRadarChart(this._points,e),e&&(this._hasAnimated=!0)}}static{this.styles=s`
    ${o(pr)}
  `}};t([ut({type:Boolean,reflect:!0})],Yr.prototype,"editMode",void 0),t([ut({attribute:!1})],Yr.prototype,"hass",void 0),t([pt()],Yr.prototype,"_config",void 0),t([pt()],Yr.prototype,"_points",void 0),t([pt()],Yr.prototype,"_markers",void 0),t([pt()],Yr.prototype,"_tooltip",void 0),t([pt()],Yr.prototype,"_pulsingEntityId",void 0),t([pt()],Yr.prototype,"_error",void 0),t([pt()],Yr.prototype,"_editingMarker",void 0),t([pt()],Yr.prototype,"_isTestingAnimation",void 0),Yr=t([ct(Xr)],Yr),"undefined"!=typeof window&&(window.customCards=window.customCards||[],window.customCards.push({type:Xr,name:"Radar Card",description:"A card to display radar data.",documentationURL:"https://github.com/timmaurice/lovelace-radar-card",preview:!0}));const Gr=s`.color-input-wrapper{align-items:center;display:flex;gap:8px;position:relative}.color-input-wrapper ha-textfield{flex-grow:1}.color-picker-popup{background-color:var(--card-background-color, white);border:1px solid var(--divider-color);border-radius:8px;box-shadow:0px 5px 5px -3px rgba(0,0,0,.2),0px 8px 10px 1px rgba(0,0,0,.14),0px 3px 14px 2px rgba(0,0,0,.12);left:0;padding:8px;position:absolute;top:100%;z-index:10}.color-picker-popup.popup-top{border-bottom-left-radius:0;border-bottom-right-radius:0;bottom:100%;top:auto}.color-picker-popup hex-color-picker{height:200px;width:200px}.clear-button{color:var(--secondary-text-color)}.color-preview{border:1px solid var(--divider-color);border-radius:4px;box-sizing:border-box;cursor:pointer;flex-shrink:0;height:28px;width:28px}.card-config{display:flex;flex-direction:column;gap:16px}.side-by-side{display:flex;gap:16px}.side-by-side>*{flex:1}.entities-container{display:flex;flex-direction:column;gap:12px}.entities-container.drag-active .entity-row:not(.is-dragging)>*{pointer-events:none}.entity-row{align-items:center;border-radius:4px;display:flex;gap:8px;padding:4px;transition:background-color .2s ease-in-out}.entity-row ha-entity-picker{flex-grow:1}.entity-row>ha-icon-button{margin-left:auto}.entity-row .drag-handle{color:var(--secondary-text-color);cursor:move}.entity-row.is-dragging{background:rgba(var(--rgb-primary-color), 0.1);opacity:.5}.entity-row.drag-over{background:rgba(var(--rgb-accent-color), 0.1)}.header{align-items:center;display:flex;gap:8px}.header .title{font-size:1.2em;font-weight:bold}.option-group{border:1px solid var(--divider-color);border-radius:var(--ha-card-border-radius, 4px);display:flex;flex-direction:column;gap:16px;padding:16px}.option-group-title{align-items:center;border-top:1px solid var(--divider-color);color:var(--primary-text-color);display:flex;font-weight:bold;gap:4px;justify-content:space-between;padding-top:1em}.option-group-title:first-child{border-top:none;padding-top:0}.option-sub-group{display:flex;flex-direction:column;gap:8px}.option-row{align-items:center;display:flex;gap:16px}.label-with-help{align-items:center;display:flex;flex-grow:1;justify-content:space-between}.radio-label{align-items:center;display:inline-flex}.help-icon{color:var(--secondary-text-color);cursor:pointer}.help-text{color:var(--secondary-text-color);font-size:12px;margin-top:-8px;padding-left:52px}.help-text.no-indent{margin-top:0;padding-left:0}.duration-with-test-button{align-items:center;display:flex;gap:8px}.duration-with-test-button ha-textfield{flex-grow:1}.duration-with-test-button ha-button{--mdc-button-padding-horizontal: 8px;flex-shrink:0}.button-row{display:flex;justify-content:flex-start;width:100%}`;window.customElements.get("hex-color-picker")||window.customElements.define("hex-color-picker",class extends Ur{});let Jr=class extends st{constructor(){super(...arguments),this._colorPickerOpenFor=null,this._editingIndex=null,this._draggedIndex=null,this._showHelpFor=new Set,this._markers=[],this._handleOutsideClick=t=>{this._colorPickerOpenFor&&(t.composedPath().some(t=>t instanceof HTMLElement&&t.dataset.pickerId===this._colorPickerOpenFor)||this._closeColorPicker())},this._loadMarkers=()=>{try{const t=localStorage.getItem("radar-card-markers");this._markers=t?JSON.parse(t):[]}catch(t){console.error("RadarCard Editor: Failed to load markers from localStorage",t),this._markers=[]}}}setConfig(t){this._config=t}disconnectedCallback(){super.disconnectedCallback(),window.removeEventListener("click",this._handleOutsideClick,{capture:!0}),window.removeEventListener("radar-card-markers-updated",this._loadMarkers)}connectedCallback(){super.connectedCallback(),this._loadMarkers(),window.addEventListener("radar-card-markers-updated",this._loadMarkers)}updated(t){super.updated(t),t.has("_colorPickerOpenFor")&&(this._colorPickerOpenFor?window.addEventListener("click",this._handleOutsideClick,{capture:!0}):window.removeEventListener("click",this._handleOutsideClick,{capture:!0}))}_handleBooleanToggle(t,e,n,i){n?i?delete t[e]:t[e]=!0:i?t[e]=!1:delete t[e]}_valueChanged(t){if(!this._config||!this.hass)return;const e=t.target;if(void 0===e.configValue)return;const n=e.configValue,i={...this._config};let r;r="value-changed"===t.type||"color-changed"===t.type?t.detail.value:"HA-SWITCH"===e.tagName?e.checked:e.value;["auto_radar_max_distance","show_grid_labels","animation_enabled","show_legend","legend_show_distance"].includes(n)?(this._handleBooleanToggle(i,n,r,!0),"auto_radar_max_distance"===n&&r&&delete i.radar_max_distance,"show_legend"!==n||r||(delete i.legend_position,delete i.legend_show_distance)):"moving_animation_enabled"===n||"enable_markers"===n?(this._handleBooleanToggle(i,n,r,!1),"moving_animation_enabled"!==n||r||(delete i.moving_animation_activities,delete i.moving_animation_attribute)):"bottom"===r&&"legend_position"===n?delete i.legend_position:"moving_animation_activities"===n?"string"==typeof r&&r.trim()?i.moving_animation_activities=r.split(",").map(t=>t.trim()).filter(Boolean):delete i.moving_animation_activities:"moving_animation_attribute"===n?"string"==typeof r&&r.trim()?i.moving_animation_attribute=r:delete i.moving_animation_attribute:"center_entity"===n?r?i.center_entity=r:delete i.center_entity:"center_latitude"===n||"center_longitude"===n?r?i[n]=Number(r):delete i[n]:"location_zone_entity"===n?r?i.location_zone_entity=r:delete i.location_zone_entity:""===r||!1===r||void 0===r||Array.isArray(r)&&0===r.length?delete i[n]:i[n]="number"===e.type?Number(r):r,qr(this,"config-changed",{config:i})}_handleCenterModeChange(t){const e=t.target.value,n={...this._config};"static"===e?(delete n.center_entity,n.location_zone_entity=n.location_zone_entity||""):(n.center_entity=n.center_entity||"",delete n.location_zone_entity),qr(this,"config-changed",{config:n})}_clearAllMarkers(){localStorage.removeItem("radar-card-markers"),window.dispatchEvent(new CustomEvent("radar-card-markers-updated")),this._markers=[]}_toggleColorPicker(t){this._colorPickerOpenFor=this._colorPickerOpenFor===t?null:t}_toggleHelp(t){this._showHelpFor.has(t)?this._showHelpFor.delete(t):this._showHelpFor.add(t),this.requestUpdate("_showHelpFor")}_closeColorPicker(){null!==this._colorPickerOpenFor&&(this._colorPickerOpenFor=null)}_renderColorInput(t,e,n,i=!1){const r=void 0!==n&&!i,a=r?this._getEntities()[n]:this._config,o=(a?a[e]:"")||"";let s=o;if("string"==typeof o&&o.startsWith("var("))try{const t=o.substring(4,o.length-1);s=getComputedStyle(this).getPropertyValue(t).trim()}catch(t){console.error("Failed to resolve CSS variable",o,t),s="#000000"}const l=r?`${e}_${n}`:e,c=this._colorPickerOpenFor===l;return B`
      <div class="color-input-wrapper" data-picker-id=${l}>
        <ha-textfield
          .label=${t}
          .value=${o}
          .configValue=${e}
          data-index=${n}
          .placeholder=${"e.g., #ff0000"}
          @input=${r?this._entityAttributeChanged:this._valueChanged}
          @click=${()=>this._toggleColorPicker(l)}
        >
          ${o?B`<ha-icon-button
                slot="trailingIcon"
                class="clear-button"
                .label=${"Clear"}
                @click=${t=>{if(t.stopPropagation(),r){const t=[...this._getEntities()],i={...t[n]};delete i[e],t[n]=i,qr(this,"config-changed",{config:{...this._config,entities:t}})}else{const t={...this._config};delete t[e],qr(this,"config-changed",{config:t})}this._closeColorPicker()}}
                title="Clear color"
              >
                <ha-icon icon="mdi:close"></ha-icon>
              </ha-icon-button>`:V}
        </ha-textfield>
        <div
          class="color-preview"
          style="background-color: ${s||"transparent"}"
          @click=${()=>this._toggleColorPicker(l)}
        ></div>
        ${c?B`
              <div class="color-picker-popup ${r?"popup-top":""}">
                <hex-color-picker
                  .configValue=${e}
                  data-index=${n}
                  .color=${s||"#000000"}
                  @color-changed=${r?this._entityAttributeChanged:this._valueChanged}
                ></hex-color-picker>
              </div>
            `:V}
      </div>
    `}_getEntities(){return this._config.entities?.map(t=>"string"==typeof t?{entity:t}:t)||[]}_addEntity(){const t=[...this._getEntities(),{entity:""}];qr(this,"config-changed",{config:{...this._config,entities:t}})}_removeEntity(t){const e=[...this._getEntities()];e.splice(t,1),qr(this,"config-changed",{config:{...this._config,entities:e}})}_entityAttributeChanged(t){if(!this._config||!this.hass||null===this._editingIndex)return;const e=t.target,n=Number(e.dataset.index),i=e.configValue;if(isNaN(n))return;const r=[...this._getEntities()],a={...r[n]};let o;o="value-changed"===t.type||"color-changed"===t.type?t.detail.value:e.value,""===o||void 0===o?delete a[i]:a[i]=o,r[n]=a,qr(this,"config-changed",{config:{...this._config,entities:r}})}_entityValueChanged(t){const e=t.target,n=e.index,i=[...this._getEntities()];i[n]={...i[n],entity:e.value},qr(this,"config-changed",{config:{...this._config,entities:i}})}_testAnimation(){qr(this,"radar-card-test-animation")}_editEntity(t){this._editingIndex=t,this.requestUpdate()}_goBack(){this._editingIndex=null,this.requestUpdate()}_handleDragStart(t,e){this._draggedIndex=e,t.dataTransfer&&(t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain","")),t.currentTarget.classList.add("is-dragging"),this.shadowRoot?.querySelector(".entities-container")?.classList.add("drag-active")}_handleDragEnter(t){t.preventDefault();const e=t.currentTarget;e.dataset.index!==String(this._draggedIndex)&&e.classList.add("drag-over")}_handleDragOver(t){t.preventDefault()}_handleDragLeave(t){t.currentTarget.classList.remove("drag-over")}_handleDrop(t,e){if(t.preventDefault(),t.currentTarget.classList.remove("drag-over"),null===this._draggedIndex||this._draggedIndex===e)return;const n=[...this._getEntities()],[i]=n.splice(this._draggedIndex,1);n.splice(e,0,i),qr(this,"config-changed",{config:{...this._config,entities:n}})}_handleDragEnd(){this.shadowRoot?.querySelectorAll(".entity-row").forEach(t=>{t.classList.remove("is-dragging","drag-over")}),this.shadowRoot?.querySelector(".entities-container")?.classList.remove("drag-active"),this._draggedIndex=null}_renderEntityEditor(){if(null===this._editingIndex)return V;const t=this._getEntities()[this._editingIndex];if(!t)return V;const e=this.hass.states[t.entity],n=t.name||e?.attributes.friendly_name||t.entity;return B`
      <div class="card-content card-config">
        <div class="header">
          <ha-icon-button @click=${this._goBack}>
            <ha-icon icon="mdi:arrow-left"></ha-icon>
          </ha-icon-button>
          <span class="title">${n}</span>
        </div>
        <div class="option-group">
          <ha-textfield
            .label=${tn(this.hass,"component.radar-card.editor.name")}
            .value=${t.name||""}
            .configValue=${"name"}
            data-index=${this._editingIndex}
            @input=${this._entityAttributeChanged}
          ></ha-textfield>
          ${this._renderColorInput(tn(this.hass,"component.radar-card.editor.color"),"color",this._editingIndex,!1)}
        </div>
      </div>
    `}render(){if(!this.hass||!this._config)return B``;if(null!==this._editingIndex)return B`<ha-card>${this._renderEntityEditor()}</ha-card>`;const t="center_entity"in this._config?"moving":"static";return B`
      <ha-card>
        <div class="card-content card-config">
          <div class="option-group">
            <div class="option-group-title">${tn(this.hass,"component.radar-card.editor.data")}</div>
            <ha-textfield
              .label=${tn(this.hass,"component.radar-card.editor.title")}
              .value=${this._config.title||""}
              .configValue=${"title"}
              @input=${this._valueChanged}
            ></ha-textfield>
            <div class="option-row">
              <ha-switch
                .checked=${!1!==this._config.auto_radar_max_distance}
                .configValue=${"auto_radar_max_distance"}
                @change=${this._valueChanged}
              ></ha-switch>
              <div class="label-with-help">
                <label class="mdc-label"
                  >${tn(this.hass,"component.radar-card.editor.auto_radar_max_distance")}</label
                >
                <ha-icon
                  class="help-icon"
                  icon="mdi:help-circle-outline"
                  @click=${()=>this._toggleHelp("auto_radar_max_distance")}
                ></ha-icon>
              </div>
            </div>
            ${this._showHelpFor.has("auto_radar_max_distance")?B`
                  <div class="help-text">
                    ${tn(this.hass,"component.radar-card.editor.auto_radar_max_distance_help")}
                  </div>
                `:V}
            ${!1!==this._config.auto_radar_max_distance?V:B`
                  <ha-textfield
                    .label=${tn(this.hass,"component.radar-card.editor.radar_max_distance")}
                    type="number"
                    .value=${this._config.radar_max_distance||""}
                    .configValue=${"radar_max_distance"}
                    @input=${this._valueChanged}
                  ></ha-textfield>
                `}
            <div class="option-sub-group">
              <div class="label-with-help">
                <label class="mdc-label"
                  >${tn(this.hass,"component.radar-card.editor.center_coords_override")}</label
                >
                <ha-icon
                  class="help-icon"
                  icon="mdi:help-circle-outline"
                  @click=${()=>this._toggleHelp("center_coords_override")}
                ></ha-icon>
              </div>
              ${this._showHelpFor.has("center_coords_override")?B`
                    <div class="help-text no-indent">
                      ${tn(this.hass,"component.radar-card.editor.center_coords_override_help")}
                    </div>
                  `:V}
              <div class="option-row">
                <ha-form-radio .name=${"centerMode"} .value=${t} @change=${this._handleCenterModeChange}>
                  <label class="radio-label">
                    <ha-radio .value=${"static"} .checked=${"static"===t}></ha-radio>
                    <span>${tn(this.hass,"component.radar-card.editor.center_modes.static")}</span>
                  </label>
                  <label class="radio-label">
                    <ha-radio .value=${"moving"} .checked=${"moving"===t}></ha-radio>
                    <span>${tn(this.hass,"component.radar-card.editor.center_modes.moving")}</span>
                  </label>
                </ha-form-radio>
              </div>
              ${"static"===t?B`<ha-entity-picker
                    .hass=${this.hass}
                    .value=${this._config.location_zone_entity||""}
                    .configValue=${"location_zone_entity"}
                    @value-changed=${this._valueChanged}
                    .label=${tn(this.hass,"component.radar-card.editor.location_zone_entity")}
                    .includeDomains=${["zone"]}
                    allow-custom-entity
                  ></ha-entity-picker>`:B`<ha-entity-picker
                    .label=${tn(this.hass,"component.radar-card.editor.center_entity")}
                    .hass=${this.hass}
                    .value=${this._config.center_entity||""}
                    .configValue=${"center_entity"}
                    @value-changed=${this._valueChanged}
                    .includeDomains=${["device_tracker","person"]}
                    allow-custom-entity
                  ></ha-entity-picker>`}
              ${"moving"===t?B`
                    <div class="option-group-title">
                      <span>${tn(this.hass,"component.radar-card.editor.markers")}</span>
                      <ha-icon
                        class="help-icon"
                        icon="mdi:help-circle-outline"
                        @click=${()=>this._toggleHelp("markers_help")}
                      ></ha-icon>
                    </div>
                    ${this._showHelpFor.has("markers_help")?B`<div class="help-text no-indent">
                          ${tn(this.hass,"component.radar-card.editor.markers_help")}
                        </div>`:V}
                    <div class="option-row">
                      <ha-switch
                        .checked=${!0===this._config.enable_markers}
                        .configValue=${"enable_markers"}
                        @change=${this._valueChanged}
                      ></ha-switch>
                      <label class="mdc-label"
                        >${tn(this.hass,"component.radar-card.editor.enable_markers")}</label
                      >
                    </div>
                    ${this._config.enable_markers?B`<div class="button-row">
                          <ha-button @click=${this._clearAllMarkers} .disabled=${0===this._markers.length}>
                            ${tn(this.hass,"component.radar-card.editor.clear_all_markers")}
                          </ha-button>
                        </div>`:V}
                  `:V}
            </div>
          </div>

          <div class="option-group entities">
            <div class="option-group-title">${tn(this.hass,"component.radar-card.editor.entities")}</div>
            <div class="entities-container">
              ${this._getEntities().map((t,e)=>B`
                  <div
                    class="entity-row"
                    data-index=${e}
                    draggable="true"
                    @dragstart=${t=>this._handleDragStart(t,e)}
                    @dragenter=${this._handleDragEnter}
                    @dragover=${this._handleDragOver}
                    @dragleave=${this._handleDragLeave}
                    @drop=${t=>this._handleDrop(t,e)}
                    @dragend=${this._handleDragEnd}
                  >
                    <ha-icon class="drag-handle" icon="mdi:drag"></ha-icon>
                    <ha-entity-picker
                      .hass=${this.hass}
                      .value=${t.entity}
                      .configValue=${"entities"}
                      .index=${e}
                      @value-changed=${this._entityValueChanged}
                      allow-custom-entity
                    ></ha-entity-picker>
                    <ha-icon-button .label=${"Edit"} @click=${()=>this._editEntity(e)}>
                      <ha-icon icon="mdi:pencil"></ha-icon>
                    </ha-icon-button>
                    <ha-icon-button .label=${"Remove"} @click=${()=>this._removeEntity(e)}>
                      <ha-icon icon="mdi:close"></ha-icon>
                    </ha-icon-button>
                  </div>
                `)}
            </div>
            <ha-button @click=${this._addEntity}>
              <ha-icon icon="mdi:plus" slot="icon"></ha-icon>
              ${tn(this.hass,"component.radar-card.editor.add_entity")}
            </ha-button>
          </div>

          <div class="option-group">
            <div class="option-group-title">
              <span>${tn(this.hass,"component.radar-card.editor.appearance")}</span>
              <ha-icon
                class="help-icon"
                icon="mdi:help-circle-outline"
                @click=${()=>this._toggleHelp("appearance_help")}
              ></ha-icon>
            </div>
            ${this._showHelpFor.has("appearance_help")?B`
                  <div class="help-text no-indent">
                    ${tn(this.hass,"component.radar-card.editor.color_contrast_help")}
                  </div>
                `:V}
            <div class="side-by-side">
              ${this._renderColorInput(tn(this.hass,"component.radar-card.editor.grid_color"),"grid_color",void 0,!1)}
              ${this._renderColorInput(tn(this.hass,"component.radar-card.editor.font_color"),"font_color",void 0,!1)}
            </div>
            ${this._renderColorInput(tn(this.hass,"component.radar-card.editor.entity_color"),"entity_color",void 0,!1)}
            <div class="option-row">
              <ha-switch
                .checked=${!1!==this._config.show_grid_labels}
                .configValue=${"show_grid_labels"}
                @change=${this._valueChanged}
              ></ha-switch>
              <label class="mdc-label">${tn(this.hass,"component.radar-card.editor.show_grid_labels")}</label>
            </div>
            <div class="option-group-title">
              <span>${tn(this.hass,"component.radar-card.editor.legend")}</span>
              <ha-icon
                class="help-icon"
                icon="mdi:help-circle-outline"
                @click=${()=>this._toggleHelp("legend_pulse_help")}
              ></ha-icon>
            </div>
            ${this._showHelpFor.has("legend_pulse_help")?B`<div class="help-text no-indent">
                  ${tn(this.hass,"component.radar-card.editor.legend_pulse_help")}
                </div>`:V}
            <div class="option-row">
              <ha-switch
                .checked=${!1!==this._config.show_legend}
                .configValue=${"show_legend"}
                @change=${this._valueChanged}
              ></ha-switch>
              <label class="mdc-label">${tn(this.hass,"component.radar-card.editor.show_legend")}</label>
            </div>
            ${!1!==this._config.show_legend?B`
                  <ha-select
                    .label=${tn(this.hass,"component.radar-card.editor.legend_position")}
                    .value=${this._config.legend_position||"bottom"}
                    .configValue=${"legend_position"}
                    @selected=${this._valueChanged}
                    @closed=${t=>t.stopPropagation()}
                  >
                    <mwc-list-item value="bottom"
                      >${tn(this.hass,"component.radar-card.editor.legend_positions.bottom")}</mwc-list-item
                    >
                    <mwc-list-item value="right"
                      >${tn(this.hass,"component.radar-card.editor.legend_positions.right")}</mwc-list-item
                    >
                    <mwc-list-item value="left"
                      >${tn(this.hass,"component.radar-card.editor.legend_positions.left")}</mwc-list-item
                    >
                  </ha-select>
                  <div class="option-row">
                    <ha-switch
                      .checked=${!1!==this._config.legend_show_distance}
                      .configValue=${"legend_show_distance"}
                      @change=${this._valueChanged}
                    ></ha-switch>
                    <label class="mdc-label"
                      >${tn(this.hass,"component.radar-card.editor.legend_show_distance")}</label
                    >
                  </div>
                `:V}
            <div class="option-group-title">${tn(this.hass,"component.radar-card.editor.animation")}</div>
            <div class="option-row">
              <ha-switch
                .checked=${!1!==this._config.animation_enabled}
                .configValue=${"animation_enabled"}
                @change=${this._valueChanged}
              ></ha-switch>
              <label class="mdc-label">${tn(this.hass,"component.radar-card.editor.animation_enabled")}</label>
            </div>
            ${!1!==this._config.animation_enabled?B`
                  <div class="duration-with-test-button">
                    <ha-textfield
                      .label=${tn(this.hass,"component.radar-card.editor.animation_duration")}
                      type="number"
                      .value=${this._config.animation_duration||""}
                      .configValue=${"animation_duration"}
                      @input=${this._valueChanged}
                      .suffix=${"ms"}
                    ></ha-textfield>
                    <ha-button @click=${this._testAnimation}>
                      ${tn(this.hass,"component.radar-card.editor.test_animation")}
                    </ha-button>
                  </div>
                `:V}
            <div class="option-row">
              <ha-switch
                .checked=${!0===this._config.moving_animation_enabled}
                .configValue=${"moving_animation_enabled"}
                @change=${this._valueChanged}
              ></ha-switch>
              <div class="label-with-help">
                <label class="mdc-label"
                  >${tn(this.hass,"component.radar-card.editor.moving_animation_enabled")}</label
                >
                <ha-icon
                  class="help-icon"
                  icon="mdi:help-circle-outline"
                  @click=${()=>this._toggleHelp("moving_animation_enabled")}
                ></ha-icon>
              </div>
            </div>
            ${this._showHelpFor.has("moving_animation_enabled")?B`
                  <div class="help-text">
                    ${tn(this.hass,"component.radar-card.editor.moving_animation_enabled_help")}
                  </div>
                `:V}
            ${!0===this._config.moving_animation_enabled?B`
                  <div class="side-by-side">
                    <ha-textfield
                      .label=${tn(this.hass,"component.radar-card.editor.moving_animation_attribute")}
                      .value=${this._config.moving_animation_attribute||""}
                      .configValue=${"moving_animation_attribute"}
                      .placeholder=${"activity"}
                      @input=${this._valueChanged}
                      .helper=${tn(this.hass,"component.radar-card.editor.moving_animation_attribute_help")}
                      .helperPersistent=${!0}
                    ></ha-textfield>
                    <ha-textfield
                      .label=${tn(this.hass,"component.radar-card.editor.moving_animation_activities")}
                      .value=${(this._config.moving_animation_activities||[]).join(", ")}
                      .configValue=${"moving_animation_activities"}
                      .placeholder=${"Automotive, Cycling, Walking, Driving"}
                      @input=${this._valueChanged}
                      .helper=${tn(this.hass,"component.radar-card.editor.moving_animation_activities_help")}
                      .helperPersistent=${!0}
                    ></ha-textfield>
                  </div>
                `:V}
          </div>
        </div>
      </ha-card>
    `}static{this.styles=s`
    ${o(Gr)}
  `}};t([ut({attribute:!1})],Jr.prototype,"hass",void 0),t([pt()],Jr.prototype,"_config",void 0),t([pt()],Jr.prototype,"_colorPickerOpenFor",void 0),t([pt()],Jr.prototype,"_editingIndex",void 0),t([pt()],Jr.prototype,"_draggedIndex",void 0),t([pt()],Jr.prototype,"_showHelpFor",void 0),t([pt()],Jr.prototype,"_markers",void 0),Jr=t([ct("radar-card-editor")],Jr);var Qr=Object.freeze({__proto__:null,get RadarCardEditor(){return Jr}});export{Yr as RadarCard};
